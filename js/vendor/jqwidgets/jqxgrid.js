/*
jQWidgets v1.9.0 (2012-03-23)
Copyright (c) 2011-2012 jQWidgets.
License: http://jqwidgets.com/license/
*/

(function(b){b.jqx.jqxWidget("jqxGrid","",{});b.extend(b.jqx._jqxGrid.prototype,{defineInstance:function(){this.disabled=false;this.width=600;this.height=400;this.pagerheight=28;this.groupsheaderheight=34;this.pagesize=10;this.pagesizeoptions=["5","10","20"];this.rowsheight=25;this.columnsheight=25;this.groupindentwidth=30;this.rowdetails=false;this.enablerowdetailsindent=true;this.initrowdetails=null;this.editable=false;this.editmode="selectedcell";this.pageable=false;this.groupable=false;this.sortable=false;this.filterable=false;this.autoshowfiltericon=true;this.showfiltercolumnbackground=true;this.showpinnedcolumnbackground=true;this.showsortcolumnbackground=true;this.altrows=false;this.altstart=1;this.altstep=1;this.showrowdetailscolumn=true;this.groups=[];this.groupsrenderer=null;this.groupcolumnrenderer=null;this.groupsexpandedbydefault=false;this.pagerrenderer=null;this.touchmode="auto";this.columns=[];this.selectedrowindex=-1;this.selectedrowindexes=new Array();this.selectedcells=new Array();this.selectedcell=null;this.source={beforeprocessing:null,beforesend:null,loaderror:null,localdata:null,data:null,datatype:"array",datafields:[],url:"",root:"",record:"",id:"",totalrecords:0,recordstartindex:0,recordendindex:0,loadallrecords:true,sortcolumn:null,sortdirection:null,sort:null,filter:null,sortcomparer:null};this.dataview=null;this.updatedelay=0;this.autoheight=false;this.showheader=true;this.showgroupsheader=true;this.closeablegroups=true;this.scrollbarsize=15;this.virtualmode=false;this.sort=null;this.columnsmenu=true;this.columnsresize=false;this.columnsmenuwidth=15;this.sorttogglestates=2;this.rendergridrows=null;this.enableanimations=true;this.enabletooltips=false;this.selectionmode="singlerow";this.enablehover=true;this.loadingerrormessage="The data is still loading. When the data binding is completed, the Grid raises the 'bindingcomplete' event. Call this function in the 'bindingcomplete' event handler.";this.verticalscrollbarstep=5;this.verticalscrollbarlargestep=400;this.horizontalscrollbarstep=5;this.horizontalscrollbarlargestep=50;this.keyboardnavigation=true;this._updating=false;this._pagescache=new Array();this._pageviews=new Array();this._cellscache=new Array();this._rowdetailscache=new Array();this._rowdetailselementscache=new Array();this._requiresupdate=false;this._hasOpenedMenu=false;this.events=["initialized","rowclick","rowselect","rowunselect","groupexpand","groupcollapse","sort","columnclick","cellclick","pagechanged","pagesizechanged","bindingcomplete","groupschanged","filter","columnresized","cellselect","cellunselect","cellbeginedit","cellendedit","cellvaluechanged"]},createInstance:function(d){var k=b("<div tabIndex=0 style='overflow: hidden; -webkit-appearance: none; outline: none; width:100%; height: 100%; align:left; border: 0px; padding: 0px; margin: 0px; left: 0px; top: 0px; valign:top; position: relative;'><div id='wrapper"+this.element.id+"' tabIndex=1 style='overflow: hidden; -webkit-appearance: none; border: none; background: transparent; outline: none; width:100%; height: 100%; padding: 0px; margin: 0px; align:left; left: 0px; top: 0px; valign:top; position: relative;'><div id='groupsheader' style='visibility: hidden; align:left; valign:top; left: 0px; top: 0px; position: absolute;'></div><div id='content"+this.element.id+"' tabIndex=2 style='overflow: hidden; -webkit-appearance: none; border: none; background: transparent; outline: none; border: none; padding: 0px; margin-left: 0px; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; align:left; valign:top; left: 0px; top: 0px; position: absolute;'/><div id='verticalScrollBar"+this.element.id+"' style='align:left; valign:top; left: 0px; top: 0px; position: absolute;'/><div id='horizontalScrollBar"+this.element.id+"' style='align:left; valign:top; left: 0px; top: 0px; position: absolute;'/><div id='bottomRight' style='align:left; valign:top; left: 0px; top: 0px; border: none; position: absolute;'/><div id='pager' style='align:left; valign:top; left: 0px; top: 0px; position: absolute;'/></div></div>");this.element.innerText="";this.element.innerHTML="";this.host.append(k);this.host.addClass(this.toTP("jqx-grid"));this.host.addClass(this.toTP("jqx-reset"));this.host.addClass(this.toTP("jqx-rc-all"));this.wrapper=this.host.find("#wrapper"+this.element.id);this.content=this.host.find("#content"+this.element.id);this.content.addClass(this.toTP("jqx-reset"));var h=this.host.find("#verticalScrollBar"+this.element.id);var g=this.host.find("#horizontalScrollBar"+this.element.id);this.bottomRight=this.host.find("#bottomRight").addClass(this.toTP("jqx-grid-bottomright"));if(!h.jqxScrollBar){alert("jqxscrollbar is not loaded.");return}this.editors=new Array();this.vScrollBar=h.jqxScrollBar({vertical:true,touchMode:this.touchmode,step:this.verticalscrollbarstep,largestep:this.verticalscrollbarlargestep,theme:this.theme,_triggervaluechanged:false});this.hScrollBar=g.jqxScrollBar({vertical:false,touchMode:this.touchmode,step:this.horizontalscrollbarstep,largestep:this.horizontalscrollbarlargestep,theme:this.theme,triggervaluechanged:false});this.pager=this.host.find("#pager");this.pager.addClass(this.toTP("jqx-grid-pager"));this.groupsheader=this.host.find("#groupsheader");this.groupsheader.addClass(this.toTP("jqx-grid-groups-header"));this.vScrollBar.css("visibility","hidden");this.hScrollBar.css("visibility","hidden");this.vScrollInstance=b.data(this.vScrollBar[0],"jqxScrollBar").instance;this.hScrollInstance=b.data(this.hScrollBar[0],"jqxScrollBar").instance;this.gridtable=null;this.dataloadelement=b('<div style="position: absolute;"></div>');this.dataloadelement.addClass(this.toTP("jqx-grid-load"));this.dataloadelement.width(this.width);this.dataloadelement.height(this.height);this.host.prepend(this.dataloadelement);this.isNestedGrid=this.host.parent()?this.host.parent().css("z-index")==2000:false;if(this.localizestrings){this.localizestrings()}this.databind(this.source);if(this.pageable&&this._initpager){this._initpager()}this._arrange();this.tableheight=null;var f=this;var e=function(){if(f.content){f.content[0].scrollTop=0;f.content[0].scrollLeft=0}if(f.gridcontent){f.gridcontent[0].scrollLeft=0;f.gridcontent[0].scrollTop=0}};this.content.bind("mousedown",function(){e()});this.content.bind("scroll",function(l){e();return false});this.host.addClass("jqx-disableselect");this.content.addClass("jqx-disableselect")},getTouches:function(d){if(d.originalEvent){if(d.originalEvent.touches&&d.originalEvent.touches.length){return d.originalEvent.touches}else{if(d.originalEvent.changedTouches&&d.originalEvent.changedTouches.length){return d.originalEvent.changedTouches}}}if(!d.touches){d.touches=new Array();d.touches[0]=d.originalEvent}return d.touches},isTouchDevice:function(){if(this.touchDevice!=undefined){return this.touchDevice}var d=b.jqx.mobile.isTouchDevice();this.touchDevice=d;if(this.touchmode==true){d=true;b.jqx.mobile.setMobileSimulator(this.element)}else{if(this.touchmode==false){d=false}}return d},toTP:function(d){return this.toThemeProperty(d)},localizestrings:function(d){this._cellscache=new Array();if(b.jqx.dataFormat){b.jqx.dataFormat.cleardatescache()}if(this._loading){alert(this.loadingerrormessage);return false}if(d!=null){if(d.pagergotopagestring){this.gridlocalization.pagergotopagestring=d.pagergotopagestring}if(d.pagershowrowsstring){this.gridlocalization.pagershowrowsstring=d.pagershowrowsstring}if(d.pagerrangestring){this.gridlocalization.pagerrangestring=d.pagerrangestring}if(d.pagernextbuttonstring){this.gridlocalization.pagernextbuttonstring=d.pagernextbuttonstring}if(d.pagerpreviousbuttonstring){this.gridlocalization.pagerpreviousbuttonstring=d.pagerpreviousbuttonstring}if(d.groupsheaderstring){this.gridlocalization.groupsheaderstring=d.groupsheaderstring}if(d.sortascendingstring){this.gridlocalization.sortascendingstring=d.sortascendingstring}if(d.sortdescendingstring){this.gridlocalization.sortdescendingstring=d.sortdescendingstring}if(d.sortremovestring){this.gridlocalization.sortremovestring=d.sortremovestring}if(d.groupbystring){this.gridlocalization.groupbystring=d.groupbystring}if(d.groupremovestring){this.gridlocalization.groupremovestring=d.groupremovestring}if(d.firstDay){this.gridlocalization.firstDay=d.firstDay}if(d.days){this.gridlocalization.days=d.days}if(d.months){this.gridlocalization.months=d.months}if(d.AM){this.gridlocalization.AM=d.AM}if(d.PM){this.gridlocalization.PM=d.PM}if(d.percentsymbol){this.gridlocalization.percentsymbol=d.percentsymbol}if(d.currencysymbol){this.gridlocalization.currencysymbol=d.currencysymbol}if(d.currencysymbolposition){this.gridlocalization.currencysymbolposition=d.currencysymbolposition}if(d.decimalseparator){this.gridlocalization.decimalseparator=d.decimalseparator}if(d.thousandsseparator){this.gridlocalization.thousandsseparator=d.thousandsseparator}if(d.filterclearstring){this.gridlocalization.filterclearstring=d.filterclearstring}if(d.filterstring){this.gridlocalization.filterstring=d.filterstring}if(d.filtershowrowstring){this.gridlocalization.filtershowrowstring=d.filtershowrowstring}if(d.filterorconditionstring){this.gridlocalization.filterorconditionstring=d.filterorconditionstring}if(d.filterandconditionstring){this.gridlocalization.filterandconditionstring=d.filterandconditionstring}if(d.filterstringcomparisonoperators){this.gridlocalization.filterstringcomparisonoperators=d.filterstringcomparisonoperators}if(d.filternumericcomparisonoperators){this.gridlocalization.filternumericcomparisonoperators=d.filternumericcomparisonoperators}if(d.filterdatecomparisonoperators){this.gridlocalization.filterdatecomparisonoperators=d.filterdatecomparisonoperators}if(this._initpager){this._initpager()}if(this._initgroupsheader){this._initgroupsheader()}if(this._initmenu){this._initmenu()}if(d.validationstring){this.gridlocalization.validationstring=d.validationstring}this._renderrows()}else{this.gridlocalization={"/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy\u0027-\u0027MM\u0027-\u0027dd\u0027T\u0027HH\u0027:\u0027mm\u0027:\u0027ss"},percentsymbol:"%",currencysymbol:"$",currencysymbolposition:"before",decimalseparator:".",thousandsseparator:",",pagergotopagestring:"Go to page:",pagershowrowsstring:"Show rows:",pagerrangestring:" of ",pagerpreviousbuttonstring:"previous",pagernextbuttonstring:"next",groupsheaderstring:"Drag a column and drop it here to group by that column",sortascendingstring:"Sort Ascending",sortdescendingstring:"Sort Descending",sortremovestring:"Remove Sort",groupbystring:"Group By this column",groupremovestring:"Remove from groups",filterclearstring:"Clear",filterstring:"Filter",filtershowrowstring:"Show rows where:",filterorconditionstring:"Or",filterandconditionstring:"And",filterstringcomparisonoperators:["empty","not empty","contains","contains(match case)","does not contain","does not contain(match case)","starts with","starts with(match case)","ends with","ends with(match case)","equal","equal(match case)","null","not null"],filternumericcomparisonoperators:["equal","not equal","less than","less than or equal","greater than","greater than or equal","null","not null"],filterdatecomparisonoperators:["equal","not equal","less than","less than or equal","greater than","greater than or equal","null","not null"],validationstring:"Entered value is not valid"}}},_initmenu:function(){var t=this;if(this.host.jqxMenu){if(this.gridmenu){this.gridmenu.jqxMenu("destroy");this.gridmenu.remove()}this.menuitemsarray=new Array();this.gridmenu=b('<div id="'+this.element.id+'" style="z-index: 9999999999999;"></div>');this.host.append(this.gridmenu);var y=b("<ul></ul>");var h='<div class="jqx-grid-sortasc-icon"></div>';var v=b("<li>"+h+this.gridlocalization.sortascendingstring+"</li>");var B='<div class="jqx-grid-sortdesc-icon"></div>';var z=b("<li>"+B+this.gridlocalization.sortdescendingstring+"</li>");var p='<div class="jqx-grid-sortremove-icon"></div>';var l=b("<li>"+p+this.gridlocalization.sortremovestring+"</li>");var k='<div class="jqx-grid-groupby-icon"></div>';var s=b("<li>"+k+this.gridlocalization.groupbystring+"</li>");var f=b("<li>"+k+this.gridlocalization.groupremovestring+"</li>");var d=b('<li type="separator"></li>');var w=b('<li class="filter" style="height: 170px;" ignoretheme="true"><div class="filter"></div></li>');var o=this.gridlocalization.sortascendingstring.length;var u=this.gridlocalization.sortascendingstring;if(this.gridlocalization.sortdescendingstring.length>o){o=this.gridlocalization.sortdescendingstring.length;u=this.gridlocalization.sortdescendingstring}if(this.gridlocalization.sortremovestring.length>o){o=this.gridlocalization.sortremovestring.length;u=this.gridlocalization.sortremovestring}if(this.groupable&&this._initgroupsheader){if(this.gridlocalization.groupbystring.length>o){o=this.gridlocalization.groupbystring.length;u=this.gridlocalization.groupbystring}if(this.gridlocalization.groupremovestring.length>o){o=this.gridlocalization.groupremovestring.length;u=this.gridlocalization.groupremovestring}}var A=200;u=b.trim(u).replace(/\&nbsp\;/ig,"").replace(/\&#160\;/ig,"");var g=b("<span>"+u+"</span>");this.host.append(g);A=g.outerWidth()+60;g.remove();var e=0;if(this.sortable&&this._togglesort){y.append(v);this.menuitemsarray[0]=v[0];y.append(z);this.menuitemsarray[1]=z[0];y.append(l);this.menuitemsarray[2]=l[0];e=3}if(this.groupable&&this._initgroupsheader){y.append(s);this.menuitemsarray[3]=s[0];y.append(f);this.menuitemsarray[4]=f[0];e+=2}var n=e*27+3;var r=true;if(this.filterable){if(this._initfilterpanel){this.menuitemsarray[5]=w[0];this.menuitemsarray[6]=w[0];y.append(d);y.append(w);n+=176;var q=b(w).find("div:first");A+=20;this._initfilterpanel(this,q,"",A);r=false;this.addHandler(b(document),"click.menu"+t.element.id,t._closemenuafterclick,t)}else{alert("jqxgrid.filter.js is not loaded.")}}this.gridmenu.append(y);if(this.menuitemsarray[0]==undefined){n=65}this.addHandler(this.gridmenu,"keydown",function(D){if(D.keyCode==27){t.gridmenu.jqxMenu("close")}else{if(D.keyCode==13&&t.filterable){var C=b.data(document.body,"contextmenu"+t.element.id).column;t.gridmenu.jqxMenu("close");t._buildfilter(t,w,C)}}});this.gridmenu.jqxMenu({width:A,height:n,autoCloseOnClick:r,autoOpenPopup:false,mode:"popup",theme:this.theme,animationShowDuration:0,animationHideDuration:0,animationShowDelay:0});if(this.filterable){this.gridmenu.jqxMenu("_setItemProperty",w[0].id,"closeOnClick",false)}this._handlemenueevents()}else{this.columnsmenu=false}},_closemenuafterclick:function(g){var f=g!=null?g.data:this;var h=false;if(g.target.className.indexOf("filter")!=-1){return}if(g.target.className.indexOf("jqx-grid-cell")!=-1){f.gridmenu.jqxMenu("close");return}var e=f.host.offset();var d=g.pageX;var k=g.pageY;b.each(b(g.target).parents(),function(){if(this.id!=null&&this.id.indexOf("filter")!=-1){h=true;return false}if(this.className.indexOf("filter")!=-1){h=true;return false}if(this.className.indexOf("jqx-grid-cell")!=-1){f.gridmenu.jqxMenu("close");return false}if(this.className.indexOf("jqx-grid-column")!=-1){f.gridmenu.jqxMenu("close");return false}});if(h){return}if(d<e.left||d>e.left+f.host.width()){f.gridmenu.jqxMenu("close");return}if(k<e.top||k>e.top+f.host.height()){f.gridmenu.jqxMenu("close");return}},_handlemenueevents:function(){var d=this;this.removeHandler(this.gridmenu,"closed");this.addHandler(this.gridmenu,"closed",function(e){d._closemenu()});this.removeHandler(this.gridmenu,"itemclick");this.addHandler(this.gridmenu,"itemclick",function(g){var f=g.args;for(i=0;i<d.menuitemsarray.length;i++){var h=d.menuitemsarray[i];if(f==h){if(b(f).attr("ignoretheme")!=undefined){return}var k=b.data(document.body,"contextmenu"+d.element.id);var e=k.column;if(d.filterable){d.gridmenu.jqxMenu("close")}if(k!=null){switch(i){case 0:d.sortby(e.datafield,"ascending",null);break;case 1:d.sortby(e.datafield,"descending",null);break;case 2:d.sortby(e.datafield,null,null);break;case 3:d.addgroup(e.datafield);break;case 4:d.removegroup(e.datafield);break;case 5:var l=b(d.menuitemsarray[6]);b(l).css("display","block");break;case 7:break}}break}}})},getdatainformation:function(){return{rowscount:this.dataview.totalrecords,sortinformation:this.getsortinformation(),paginginformation:this.getpaginginformation()}},getsortinformation:function(){return{sortcolumn:this.sortcolumn,sortdirection:this.sortdirection}},getpaginginformation:function(){return{pagenum:this.dataview.pagenum,pagesize:this.pagesize,pagescount:Math.ceil(this.dataview.totalrecords/this.pagesize)}},_updaterowsproperties:function(){this._updatehiddenrows();this._updaterowheights();this._updaterowdetails()},_updatehiddenrows:function(){var e=this;this.hiddens=new Array();var d=this.hiddenboundrows;b.each(d,function(g){if(this.index!=undefined){var f=this.index;var h=e.getrowvisibleindex(g);e.hiddens[h]=this.hidden}})},_updaterowheights:function(){var e=this;this.heights=new Array();var d=this.heightboundrows;b.each(d,function(g){if(this.index!=undefined){var f=this.index;var h=e.getrowvisibleindex(g);e.heights[h]=this.height}})},_updaterowdetails:function(){var d=this;this.details=new Array();var e=this.detailboundrows;b.each(e,function(g){if(this.index!=undefined){var f=this.index;var h=d.getrowvisibleindex(g);d.details[h]=this.details}})},_getmenuitembyindex:function(d){if(d==undefined){return null}return this.menuitemsarray[d]},_closemenu:function(){if(this._hasOpenedMenu){if(this.gridmenu!=null){this.gridmenu.jqxMenu("close")}var g=b.data(document.body,"contextmenu"+this.element.id);var e=16;if(g!=null){if(this.enableanimations){b(g.columnsmenu).animate({"margin-left":0},"fast",function(){b(g.columnsmenu).css("display","none")});g.column.iconscontainer.animate({"margin-left":-32},"fast")}else{b(g.columnsmenu).css("display","none");g.column.iconscontainer.css("margin-left",-32)}b.data(document.body,"contextmenu"+this.element.id,null)}this._hasOpenedMenu=false;var k=this._getmenuitembyindex(5);if(k){var h=b(k).find("#filter1"+this.element.id);var d=b(k).find("#filter2"+this.element.id);var f=b(k).find("#filter3"+this.element.id);h.jqxDropDownList("hideListBox");d.jqxDropDownList("hideListBox");f.jqxDropDownList("hideListBox")}}},scrolloffset:function(e,d){if(e==null||d==null||e==undefined||d==undefined){return}this.vScrollBar.jqxScrollBar("setPosition",e);this.hScrollBar.jqxScrollBar("setPosition",d)},scrollleft:function(d){if(d==null||d==undefined){return}this.hScrollBar.jqxScrollBar("setPosition",d)},scrolltop:function(d){if(d==null||d==undefined){return}this.vScrollBar.jqxScrollBar("setPosition",d)},beginupdate:function(){this._updating=true},resumeupdate:function(){this._updating=false;this.rendergridcontent(true);this._renderrows(this.virtualsizeinfo)},updating:function(){return this._updating},refresh:function(){},databind:function(e){b(this.dataloadelement).css("visibility","visible");b(this.dataloadelement).css("display","block");if(!this._initgroupsheader&&this.groups.length>0){this.groups=new Array()}var d=this;if(e==null){e=new Array()}if(!e.recordstartindex){e.recordstartindex=0}if(!e.recordendindex){e.recordendindex=0}if(e.loadallrecords==undefined||e.loadallrecords==null){e.loadallrecords=true}if(e.sortcomparer==undefined||e.sortcomparer==null){e.sortcomparer=null}if(e.filter==undefined||e.filter==null){e.filter=null}if(e.sort==undefined||e.sort==null){e.sort=null}if(e.data==undefined||e.data==null){e.data=null}this.dataview=this.dataview||new b.jqx.dataview();if(b.jqx.dataview.sort){b.extend(this.dataview,new b.jqx.dataview.sort())}if(b.jqx.dataview.grouping){b.extend(this.dataview,new b.jqx.dataview.grouping())}this.dataview.suspendupdate();this.dataview.pageable=this.pageable;this.dataview.groupable=this.groupable;this.dataview.groups=this.groups;this.dataview.virtualmode=this.virtualmode;this.dataview.grid=this;this._loading=true;this.dataview.update=function(){d._loading=false;if(d.dataview.isupdating()){d.dataview.resumeupdate(false)}if(d.pageable&&d.pagerrenderer){if(d._initpager){d._initpager()}else{alert("jqxgrid.pager.js is not loaded.")}}if(d.source.sortcolumn&&d.sortby){d.render();d.sortby(d.source.sortcolumn,d.source.sortdirection,d.source.sortcomparer);d.source.sortcolumn=null}else{var f=d.source.datatype;if(f!="local"||f!="array"){var g=d.virtualsizeinfo==null||(d.virtualsizeinfo!=null&&d.virtualsizeinfo.virtualheight==0);if(!d.virtualmode||d.pageable||g){d.render()}else{d._pagescache=new Array();d._renderrows()}}}b(d.dataloadelement).css("visibility","hidden");b(d.dataloadelement).css("display","none");d._raiseEvent(11);if(!d.initializedcall){d._raiseEvent(0);if(d.isTouchDevice()){d.enablehover=false;b.jqx.mobile.touchScroll(d.gridcontent[0],d.vScrollInstance.max,function(l,k){if(d.vScrollBar.css("visibility")=="visible"){var h=d.vScrollInstance.value;d.vScrollInstance.setPosition(h+k)}if(d.hScrollBar.css("visibility")=="visible"){var h=d.hScrollInstance.value;d.hScrollInstance.setPosition(h+l)}})}d.initializedcall=true;if(d.ready){d.ready()}}};this.dataview.databind(e);if(this.dataview.isupdating()){this.dataview.resumeupdate(false)}this._initializeRows()},scrollto:function(e,d){if(undefined!=e){this.hScrollInstance.setPosition(e)}if(undefined!=d){this.vScrollInstance.setPosition(d)}},ensurerowvisible:function(g){var e=this._getpagesize();var f=Math.floor(g/e);if(!this._pageviews[f]&&!this.pageable){this._updatepageviews()}var o=false;if(this.pageable&&this.gotopage){if(this.dataview.pagenum!=f){this.gotopage(f);o=true}}var l=this.vScrollInstance.value;var n=this._gettableheight()-this.rowsheight;var d=e*(g/e-f);d=Math.round(d);if(this._pageviews[f]){var k=this._pageviews[f].top;var h=k+d*this.rowsheight;if(this.rowdetails){for(i=e*f;i<g;i++){if(this.details[i].rowdetailshidden==false){h+=this.details[i].rowdetailsheight}}}if(h<l||h>l+n+2){this.scrollto(0,h);o=true}}else{if(this.pageable){var h=d*this.rowsheight;if(this.rowdetails){for(i=e*f;i<e*f+d;i++){if(this.details[i].rowdetailshidden==false){h+=this.details[i].rowdetailsheight}}}if(h<l||h>l+n){this.scrollto(0,h);o=true}}}return o},ensurecellvisible:function(g,d){var o=this.ensurerowvisible(g);var e=0;var n=this;if(this.columns.records){var k=this.hScrollBar.jqxScrollBar("value");var l=this.host.width();var h=0;var f=this.vScrollBar.css("visibility")=="visible"?20:0;b.each(this.columns.records,function(){if(this.datafield==d){var p=0;if(e+this.width>k+l-f){p=e+this.width-k-l+f;n.scrollleft(p+k);o=true}else{if(e<k){p=k-e;n.scrollleft(p);o=true}}if(h==0){n.scrollleft(0);o=true}else{if(h==n.columns.records.length-1){if(n.hScrollBar.css("visibility")=="visible"){n.scrollleft(n.hScrollBar.jqxScrollBar("max"));o=true}}}return false}h++;e+=this.width})}return o},setrowheight:function(e,d){if(this._loading){alert(this.loadingerrormessage);return false}if(e==null||d==null){return false}this.heightboundrows[e]={index:e,height:d};e=this.getrowvisibleindex(e);if(e<0){return false}if(this.rows.records[e]){this.rows.records[e].height=d}else{row=new a(this,null);row.height=d;this.rows.replace(e,row)}this.heights[e]=d;this.rendergridcontent(true);return true},getrowheight:function(d){if(d==null){return null}d=this.getrowvisibleindex(d);if(d<0){return false}if(this.rows.records[d]){return this.rows.records[d].height}},setrowdetails:function(e,f,d,h){if(e==undefined||e==null||e<0){return}var g=this.dataview.generatekey();this.detailboundrows[e]={index:e,details:{rowdetails:f,rowdetailsheight:d,rowdetailshidden:h,key:g}};e=this.getrowvisibleindex(e);if(e<0){return false}return this._setrowdetails(e,f,d,h,g)},getcolumn:function(d){var e=null;if(this.columns.records){b.each(this.columns.records,function(){if(this.datafield==d){e=this;return false}})}return e},_getcolumnindex:function(e){var d=-1;if(this.columns.records){b.each(this.columns.records,function(){d++;if(this.datafield==e){return false}})}return d},_getcolumnat:function(d){var e=this.columns.records[d];return e},getcolumnat:function(d){if(!isNaN(d)){var e=this.columns.records[d];return e}return null},_getcolumn:function(d){var e=null;b.each(this._columns,function(){if(this.datafield==d||this.dataField==d){e=this;return false}});return e},_setcolumnproperty:function(e,g,h){if(e==null||g==null||h==null){return null}var f=this.getcolumn(e);if(f==null){return}f[g]=h;var d=this._getcolumn(e);if(d!=null){d[g]=h}switch(g){case"text":this.prerenderrequired=true;this._rendercolumnheaders();if(this._groupsheader()){if(this._initgroupsheader){this._initgroupsheader()}}break;case"hidden":case"hideable":case"renderer":case"cellsrenderer":case"align":case"cellsalign":case"cellsformat":case"width":case"pinned":case"contenttype":case"resizable":case"filterable":case"editable":case"cellclass":case"class":this.prerenderrequired=true;this.rendergridcontent(true);break}},_getcolumnproperty:function(d,f){if(d==null||f==null){return null}var e=this.getcolumn(d);return e[f]},setcolumncontenttype:function(e,d){this._setcolumnproperty(e,"contenttype",d)},setcolumntext:function(d,e){this._setcolumnproperty(d,"text",e)},getcolumntext:function(d){return this._getcolumnproperty(d,"text")},setcolumncellsformat:function(d,e){this._setcolumnproperty(d,"cellsformat",e)},getcolumncellsformat:function(d){return this._getcolumnproperty(d,"cellsformat")},getcolumncontenttype:function(d){return this._getcolumnproperty(d,"contenttype")},hidecolumn:function(d){this._setcolumnproperty(d,"hidden",true)},showcolumn:function(d){this._setcolumnproperty(d,"hidden",false)},iscolumnvisible:function(d){return !this._getcolumnproperty(d,"hidden")},setcolumnhideable:function(d,e){this._setcolumnproperty(d,"hideable",e)},iscolumnhideable:function(d){return this._getcolumnproperty(d,"hideable")},setcolumnrenderer:function(d,e){this._setcolumnproperty(d,"renderer",e)},setcolumncellsrenderer:function(d,e){this._setcolumnproperty(d,"cellsrenderer",e)},setcolumnalign:function(d,e){this._setcolumnproperty(d,"align",e)},getcolumnalign:function(d){return this._getcolumnproperty(d,"align")},setcolumncellsalign:function(d,e){this._setcolumnproperty(d,"cellsalign",e)},getcolumncellsalign:function(d){return this._getcolumnproperty(d,"cellsalign")},setcolumnwidth:function(d,f){if(f!=undefined){var e=parseInt(f);this._setcolumnproperty(d,"width",e)}},getcolumnwidth:function(d){return this._getcolumnproperty(d,"width")},pincolumn:function(d){this._setcolumnproperty(d,"pinned",true)},unpincolumn:function(d){this._setcolumnproperty(d,"pinned",false)},iscolumnpinned:function(d){return this._getcolumnproperty(d,"pinned")},_setrowdetails:function(h,d,o,g,e){if(o==0){o=100}if(h==null||o==null){return false}if(e!=null){this.details[h]={rowdetails:d,rowdetailsheight:o,rowdetailshidden:g,detailskey:e}}else{var n=this.details[h]!=null?this.details[h].detailskey:null;var l={rowdetails:d,rowdetailsheight:o,rowdetailshidden:g,detailskey:n};var k=this;for(i=0;i<this.detailboundrows.length;i++){if(this.detailboundrows[i]!=undefined){var f=this.detailboundrows[i];if(f.details.key==n){f.details.rowdetailsheight=l.rowdetailsheight;f.details.rowdetailshidden=l.rowdetailshidden;f.details.rowdetails=l.rowdetails;break}}}this.details[h]=l}this.rendergridcontent(true);return true},getrowdetails:function(d){if(d==null){return false}d=this.getrowvisibleindex(d);return this._getrowdetails(d)},_getrowdetails:function(d){if(d==null){return false}if(d<0){return false}if(this.details[d]){return this.details[d]}},getrecordscount:function(){return this.dataview.totalrecords},showrowdetails:function(d){if(this._loading){alert(this.loadingerrormessage);return false}if(d==null){return false}d=this.getrowvisibleindex(d);if(d<0){return false}var e=this._getrowdetails(d);return this._setrowdetailsvisibility(d,e,false)},hiderowdetails:function(d){if(this._loading){alert(this.loadingerrormessage);return false}d=this.getrowvisibleindex(d);if(d<0){return false}var e=this._getrowdetails(d);return this._setrowdetailsvisibility(d,e,true)},_togglerowdetails:function(g){var d=g.visibleindex;var e=this._getrowdetails(d);if(e!=null){var f=!e.rowdetailshidden;return this._setrowdetailsvisibility(d,e,f)}return false},_setrowdetailsvisibility:function(e,f,g){if(f!=null){this.details[e].rowdetailshidden=g}else{return false}var d=this.details[e];return this._setrowdetails(e,d.rowdetails,d.rowdetailsheight,d.rowdetailshidden)},getrowvisibleindex:function(d){if(d==undefined||d==null||d<0){return false}if(this.virtualmode){var e=this.dataview.loadedrecords[d];if(e==undefined){return -1}return e.visibleindex}var e=this.dataview.bounditems[d];if(e==undefined){return -1}return e.visibleindex},hiderow:function(d){if(this._loading){alert(this.loadingerrormessage);return false}if(d==undefined||d==null||d<0){return false}if(d==null){return false}this.hiddenboundrows[d]={index:d,hidden:true};d=this.getrowvisibleindex(d);return this._setrowvisibility(d,true)},showrow:function(d){if(this._loading){alert(this.loadingerrormessage);return false}if(d==undefined||d==null||d<0){return false}if(d==null){return false}this.hiddenboundrows[d]={index:d,hidden:false};d=this.getrowvisibleindex(d);return this._setrowvisibility(d,false)},isrowhiddenat:function(d){if(d==null){return null}d=this.getrowvisibleindex(d);if(this.rows.records[d]){return this.rows.records[d].hidden}},_setrowvisibility:function(d,f,e){if(d==null){return false}this.hiddens[d]=f;if(e==undefined||e){this.rendergridcontent(true);return true}return false},_loadrows:function(){if(!this._pageviews[this.dataview.pagenum]&&!this.pageable){return}var q=!this.pageable?this._pageviews[this.dataview.pagenum].top:0;if(!this.pageable&&this._pagescache[this.dataview.pagenum]!=undefined){return null}if(!this.virtualsizeinfo){return}var u=this;var l=new Array();var r=new Array();var e=u.groupable&&u.groups.length>0;var h=this.dataview.totalrecords;var p=this.virtualsizeinfo.virtualheight;var t=0;this.rows.beginupdate();var f=this.dataview.pagesize;if(this.pageable&&e){f=this.dataview.rows.length}for(i=0;i<f;i++){if(i>=this.dataview.rows.length){break}var k=this.dataview.rows[i];var v=null;if(!u.rows.records[k.visibleindex]){v=new a(u,k)}else{v=u.rows.records[k.visibleindex];v.setdata(k)}v.hidden=this.hiddens[v.visibleindex];var d=this.details[v.visibleindex];if(d){v.rowdetails=d.rowdetails;v.rowdetailsheight=d.rowdetailsheight;v.rowdetailshidden=d.rowdetailshidden}else{v.rowdetails=null}if(e&&this.pageable&&v.parentbounddata!=null){var s=l[v.parentbounddata.uniqueid];if(s!=null){var o=this._findgroupstate(s.uniqueid);if(this._setsubgroupsvisibility){this._setsubgroupsvisibility(this,v.parentbounddata,!o,false)}v.hidden=this.hiddens[v.visibleindex]}if(s!=null&&s!=undefined){v.parentrow=s;s.subrows[s.subrows.length++]=v}}if(v.hidden){continue}var g=k.visibleindex;if(!this.heights[g]){this.heights[g]=this.rowsheight}v.height=this.heights[g];if(this.rowdetails){if(v.rowdetails&&!v.rowdetailshidden){v.height+=v.rowdetailsheight}}l[v.uniqueid]=v;r[t++]=v;v.top=q;q+=v.height;var n=g;u.rows.replace(n,v)}this.rows.resumeupdate();if(r.length>0){this._pagescache[this.dataview.pagenum]=r}},_gettableheight:function(){if(this.tableheight!=undefined){return this.tableheight}var e=this.host.height();if(this.columnsheader){var d=this.columnsheader.outerHeight();if(!this.showheader){d=0}}e-=d;if(this.hScrollBar.css("visibility")=="visible"){e-=this.hScrollBar.outerHeight()}if(this.pageable){e-=this.pager.outerHeight()}if(this._groupsheader()){e-=this.groupsheader.outerHeight()}if(e>0){this.tableheight=e;return e}return this.host.height()},_getpagesize:function(){if(this.pageable){return this.pagesize}if(this.virtualmode){var e=Math.round(this.host.height())+2*this.rowsheight;var d=Math.round(e/this.rowsheight);return d}if(this.dataview.totalrows<100&&this.dataview.totalrecords<100&&this.dataview.totalrows>0){return this.dataview.totalrows}return 100},_calculatevirtualheight:function(){var p=this;var e=Math.round(this.host.height())+2*this.rowsheight;realheight=this._gettableheight();var r=Math.round(e/this.rowsheight);this.heights=new Array();this.hiddens=new Array();this.details=new Array();this.expandedgroups=new Array();this.hiddenboundrows=new Array();this.heightboundrows=new Array();this.detailboundrows=new Array();var h=Math.max(this.dataview.totalrows,this.dataview.totalrecords);if(this.pageable){h=this.pagesize}var n=h*this.rowsheight;var o=0;var k=0;var l=0;var f=this._getpagesize();var d=f*this.rowsheight;var g=0;while(g<=h+f){o+=d;if(g-f<h&&g>=h){var q=g-h;if(q>0){l-=d;this._pageviews[k-1]={top:l,height:d-q*this.rowsheight}}break}else{this._pageviews[k++]={top:l,height:d}}l=o;g+=f}this.vScrollBar.jqxScrollBar({value:0});if(n>realheight&&!this.autoheight){this.vScrollBar.css("visibility","visible");this.vScrollBar.jqxScrollBar({max:n-realheight})}else{this.vScrollBar.css("visibility","hidden")}this.dataview.pagesize=f;this.dataview.updateview();return{visiblerecords:r,virtualheight:n}},_updatepageviews:function(){if(this.updating()){return}this._pagescache=new Array();this._pageviews=new Array();this.tableheight=null;var u=this;var d=Math.round(this.host.height())+2*this.rowsheight;var v=Math.round(d/this.rowsheight);var n=Math.max(this.dataview.totalrows,this.dataview.totalrecords);var q=n*this.rowsheight;var t=0;var f=0;var o=0;var p=0;var h=0;var g=this._getpagesize();if(!this.pageable){for(i=0;i<n;i++){var s={index:i,height:this.heights[i],hidden:this.hiddens[i],details:this.details[i]};if(this.heights[i]==undefined){this.heights[i]=this.rowsheight;s.height=this.rowsheight}if(this.hiddens[i]==undefined){this.hiddens[i]=false;s.hidden=false}if(this.details[i]==undefined){this.details[i]=null}if(s.height!=u.rowsheight){q-=u.rowsheight;q+=s.height}if(s.hidden){q-=s.height}else{f+=s.height;var l=0;if(this.rowdetails){if(s.details&&s.details.rowdetails&&!s.details.rowdetailshidden){l=s.details.rowdetailsheight;f+=l;q+=l}}t+=s.height+l}h++;if(h>=g||i==n-1){this._pageviews[o++]={top:p,height:f};f=0;p=t;h=0}}}else{if(this._updatepagedview){q=this._updatepagedview(n,q,0)}if(this.autoheight){this._arrange()}}var e=this._gettableheight();if(q>e){if(this.pageable&&this.gotopage){q=this._pageviews[0].height;if(q<0){q=this._pageviews[0].height}}if(this.vScrollBar.css("visibility")!="visible"){this.vScrollBar.css("visibility","visible")}if(q<=e||this.autoheight){this.vScrollBar.css("visibility","hidden")}if(q-e>0){var r=q-e;this.vScrollBar.jqxScrollBar({max:r})}else{this.vScrollBar.jqxScrollBar({value:0,max:q})}}else{this.vScrollBar.css("visibility","hidden");this.vScrollBar.jqxScrollBar({value:0})}this._arrange();if(this.autoheight){v=Math.round(this.host.height()/this.rowsheight)}this.virtualsizeinfo={visiblerecords:v,virtualheight:q}},updatebounddata:function(){this.databind(this.source)},refreshdata:function(){this._refreshdataview();this.render()},_refreshdataview:function(){this.dataview.refresh()},render:function(){this._render(true,true,true)},clear:function(){this.databind(null);this.render()},_render:function(e,f,d){if(this.dataview==null){return}if(this.editcell!=null&&this.endcelledit){this.endcelledit(this.editcell.row,this.editcell.column,true,false)}this._removeHandlers();this._addHandlers();this._initializeRows();this._requiresupdate=f!=undefined?f:true;if(d){if(!this._requiresupdate){this._initmenu()}if(this.columns==null){this.columns=new b.jqx.collection(this.element)}else{this._initializeColumns()}}this.tableheight=null;this._pagescache=new Array();this._pageviews=new Array();if(this._requiresupdate){this._clearcaches();this._initmenu()}this.virtualsizeinfo=null;this.prerenderrequired=true;if(d){this.content.html("");this.columnsheader=this.columnsheader||b('<div style="overflow: hidden;"></div>');this.columnsheader.remove();this.columnsheader.addClass(this.toTP("jqx-grid-header"))}else{if(this.gridcontent){this.gridcontent.html("")}}if(!this.showheader){this.columnsheader.css("display","none")}else{if(this.columnsheader){this.columnsheader.css("display","block")}}this.gridcontent=this.gridcontent||b('<div style="width: 100%; overflow: hidden; position: absolute;"></div>');this.gridcontent.remove();this.columnsheader.height(this.columnsheight);this.content.append(this.columnsheader);this.content.append(this.gridcontent);this._arrange();if(this._initgroupsheader){this._initgroupsheader()}this.selectionarea=this.selectionarea||b("<div style='z-index: 99999; visibility: hidden; position: absolute;'></div>");this.selectionarea.addClass(this.toThemeProperty("jqx-grid-selectionarea"));this.content.append(this.selectionarea);this.tableheight=null;this.rendergridcontent(false,d);if(this.groups.length>0&&this.groupable){this.suspendgroupevents=true;if(this.collapseallgroups){if(!this.groupsexpandedbydefault){this.collapseallgroups();this._updatescrollbarsafterrowsprerender()}else{this.expandallgroups()}}this.suspendgroupevents=false}if(this.pageable&&this.updatepagerdetails){this.updatepagerdetails();if(this.autoheight){this._updatepageviews()}}},rendergridcontent:function(d,f){if(this.updating()){return false}if(d==undefined||d==null){d=false}this._requiresupdate=d;var h=this.prerenderrequired;if(this.prerenderrequired){this._arrange()}var g=this;var f=f;if(f==null||f==undefined){f=true}this.tableheight=null;g.virtualsizeinfo=g.virtualsizeinfo||g._calculatevirtualheight();if(f){g._rendercolumnheaders()}else{if(this._rendersortcolumn){this._rendersortcolumn()}if(this._renderfiltercolumn){this._renderfiltercolumn()}}g._renderrows(g.virtualsizeinfo);if(this.gridcontent[0].scrollTop!=0){this.gridcontent[0].scrollTop=0}if(this.gridcontent[0].scrollLeft!=0){this.gridcontent[0].scrollLeft=0}if(h){var e=this.tableheight;this._arrange();if(e!=this.tableheight&&this.autoheight){g._renderrows(g.virtualsizeinfo)}}return true},_updatecolumnwidths:function(){var g=this.host.width();var f="";b.each(this.columns.records,function(n,o){if(!(this.hidden&&this.hideable)){if(this.width!="auto"&&!this._width){g-=this.width}else{f+=this.text}}});var e=this._gettableheight();if(this.virtualsizeinfo&&this.virtualsizeinfo.virtualheight>e){if(this.groupable&&this.groups.length>0){if(this.dataview&&this.dataview.loadedrootgroups&&!this.groupsexpandedbydefault){var k=this.dataview.loadedrootgroups.length*this.rowsheight;if(k>e){g-=this.scrollbarsize+5}}else{g-=this.scrollbarsize+5}}else{g-=this.scrollbarsize+5}}var l=this.columnsheader.find("#columntable"+this.element.id);if(l.length==0){return}var d=l.find(".jqx-grid-column-header");var h=0;b.each(this.columns.records,function(n,q){var p=b(d[n]);if(this.width!="auto"&&!this._width){p.width(this.width)}else{var o=Math.round(g*(this.text.length/f.length));if(o<0){$element=b("<span>"+this.text+"</span>");b(document.body).append($element);o=10+$element.width();$element.remove()}if(o<this.minwidth){o=this.minwidth}if(o>this.maxwidth){o=this.maxwidth}this._width="auto";this.width=o;p.width(this.width)}p.css("left",h);if(!(this.hidden&&this.hideable)){h+=this.width}this._requirewidthupdate=true});this.columnsheader.width(2+h)},_rendercolumnheaders:function(){var t=this;if(!this.prerenderrequired){if(this._rendersortcolumn){this._rendersortcolumn()}if(this._renderfiltercolumn){this._renderfiltercolumn()}return}this._columnsbydatafield=new Array();this.columnsheader.find("#columntable"+this.element.id).remove();var f=b('<div id="columntable'+this.element.id+'" style="height: 100%; position: relative;"></div>');f[0].cells=new Array();var h=0;var g=0;var n="";var o=this.host.width();var s=new Array();var p=new Array();b.each(this.columns.records,function(k,u){if(!(this.hidden&&this.hideable)){if(this.width!="auto"&&!this._width){if(this.width<this.minwidth&&this.minwidth!="auto"){o-=this.minwidth}else{if(this.width>this.maxwidth&&this.maxwidth!="auto"){o-=this.maxwidth}else{o-=this.width}}}else{n+=this.text}}if(this.pinned){s[s.length]=this}else{p[p.length]=this}});for(i=0;i<s.length;i++){this.columns.replace(i,s[i])}for(j=0;j<p.length;j++){this.columns.replace(s.length+j,p[j])}var r=499;var d=t.groupable?t.groups.length:0;if(this.rowdetails&&this.showrowdetailscolumn){d++}var l=t.columnsheader.height();var e=this._gettableheight();if(this.virtualsizeinfo&&this.virtualsizeinfo.virtualheight>e){if(this.groupable&&this.groups.length>0){if(this.dataview&&this.dataview.loadedrootgroups&&!this.groupsexpandedbydefault){var q=this.dataview.loadedrootgroups.length*this.rowsheight;if(q>e){o-=this.scrollbarsize+5}}else{o-=this.scrollbarsize+5}}else{if(!this.autoheight){o-=this.scrollbarsize+5}}}b.each(this.columns.records,function(L,I){var w=b('<div style="position: absolute; height: 100%;"></div>');w.addClass(t.toTP("jqx-grid-column-header"));if(this.classname!=""&&this.classname){w.addClass(this.classname)}w.css("z-index",r--);var E=this.width;if(this.width!="auto"&&!this._width){if(E<this.minwidth&&this.minwidth!="auto"){E=this.minwidth}if(E>this.maxwidth&&this.maxwidth!="auto"){E=this.maxwidth}w.width(E)}else{var H=Math.round(o*(this.text.length/n.length));if(H<0){$element=b("<span>"+this.text+"</span>");b(document.body).append($element);H=10+$element.width();$element.remove()}if(H<this.minwidth){H=this.minwidth}if(H>this.maxwidth){H=this.maxwidth}this._width="auto";this.width=H;E=this.width;w.width(this.width)}if(this.hidden&&this.hideable){w.css("display","none")}var u=b('<div style="height: 100%; width: 100%;"></div>');var A=b('<div style="display: none; left: 100%; top: 0%; position: absolute;"></div>');var C=b('<div style="width: 100%; height:100%;"></div>');C.addClass(t.toTP("jqx-grid-column-menubutton"));C.appendTo(A);A.height(l);A.addClass(t.toTP("jqx-fill-state-normal"));if(!t.enableanimations){A.css("margin-left",-16)}var F=b('<div class="sortasc" style="float: right; display: none; width: 16px;"><div style="width: 100%; height:100%;"></div></div>');var G=b('<div class="sortdesc" style="float: right; display: none; width: 16px;"><div style="width: 100%; height:100%;"></div></div>');var K=b('<div class="filtericon" style="float: right; display: none; width: 16px;"><div style="width: 100%; height:100%;"></div></div>');if(!t.autoshowfiltericon){K.css("display","block")}F.height(l);G.height(l);K.height(l);F.addClass(t.toTP("jqx-fill-state-normal"));G.addClass(t.toTP("jqx-fill-state-normal"));K.addClass(t.toTP("jqx-fill-state-normal"));F.find("div").addClass(t.toTP("jqx-grid-column-sortascbutton"));G.find("div").addClass(t.toTP("jqx-grid-column-sortdescbutton"));K.find("div").addClass(t.toTP("jqx-grid-column-filterbutton"));this.sortasc=F[0];this.sortdesc=G[0];this.filtericon=K[0];this.columnsmenu=A[0];f[0].cells[L]=w[0];A.width(t.columnsmenuwidth);var z=t.columnsmenu;var v=false;var J=false;if((t.groupable&&d>0&&h<d)||(t.rowdetails&&h<d)){h++;z&=false;this.sortable=false;this.editable=false;J=true}else{var B=this.renderer!=null?this.renderer(this.text,this.align):t._rendercolumnheader(this.text,this.align);if(B==null){B=t._rendercolumnheader(this.text,this.align)}z&=true;v=true}u.append(B);if(B!=null){var D=b('<div class="iconscontainer" style="margin-left: -32px; display: block; position: absolute; left: 100%; top: 0%; width: 32px;"></div>');D.height(l);u.append(D);D.append(K);D.append(F);D.append(G);this.iconscontainer=D}if(z){t._handlecolumnsmenu(t,u,w,A,this)}w.append(u);f.append(w);if(t.groupable&&v){w[0].id=t.dataview.generatekey();if(t._handlecolumnstogroupsdragdrop){t._handlecolumnstogroupsdragdrop(this,w)}else{alert("jqxgrid.grouping.js is not loaded")}}var M=this;t.addHandler(w,"click",function(){if(t.sorttogglestates>0&&t._togglesort){t._togglesort(M)}t._raiseEvent(7,{column:M.getcolumnproperties(),datafield:M.datafield})});if(M.resizable&&t.columnsresize&&!J&&this._width!="auto"){var y=false;var k="mousemove";if(t.isTouchDevice()){y=true;k="touchstart"}t.addHandler(w,k,function(O){var N=parseInt(O.pageX);var Q=5;var S=parseInt(w.offset().left);if(y){var P=t.getTouches(O);var R=P[0];N=R.pageX;Q=40;if(N>=S+M.width-Q){t.resizablecolumn={columnelement:w,column:M};w.css("cursor","col-resize")}else{w.css("cursor","");t.resizablecolumn=null}return true}if(N>=S+M.width-Q){if(N<=S+M.width+Q){t.resizablecolumn={columnelement:w,column:M};w.css("cursor","col-resize");return false}}else{w.css("cursor","");t.resizablecolumn=null}})}w.css("left",g);if(!(this.hidden&&this.hideable)){g+=E}});this.columnsheader.width(2+g);this.columnsrow=f;t.columnsheader.append(f);f.width(g);if(this._handlecolumnsdragdrop){this._handlecolumnsdragdrop()}if(this._rendersortcolumn){this._rendersortcolumn()}if(this._renderfiltercolumn){this._renderfiltercolumn()}if(this._handlecolumnsresize){this._handlecolumnsresize()}},_handlecolumnsmenu:function(q,e,f,h,n){q.dragmousedown=null;h[0].id=q.dataview.generatekey();e.append(h);f[0].columnsmenu=h[0];var l=16;var p=function(){if(f.css("cursor")!="col-resize"){if(q.menuitemsarray.length>0){if(!q.enableanimations){h.css("display","block");n.iconscontainer.css("margin-left","-48px")}else{h.css("display","block");h.animate({"margin-left":-l},"fast");n.iconscontainer.animate({"margin-left":-48},"fast")}}}};q.addHandler(f,"mouseenter",function(r){p()});q.addHandler(f,"mouseleave",function(r){if(q.menuitemsarray.length>0){var s=b.data(document.body,"contextmenu"+q.element.id);if(s!=undefined&&h[0].id==s.columnsmenu.id){return}if(!q.enableanimations){h.css("display","none");n.iconscontainer.css("margin-left","-32px")}else{h.css("margin-left",-l);h.animate({"margin-left":0},"fast",function(){h.css("display","none")});n.iconscontainer.animate({"margin-left":-32},"fast")}}});var k=true;var d="";var g=b(n.filtericon);q.addHandler(h,"mousedown",function(r){k=!b.data(q.gridmenu[0],"contextMenuOpened"+q.gridmenu[0].id);d=b.data(document.body,"contextmenu"+q.element.id);if(d!=null){d=d.column.datafield}});q.addHandler(g,"mousedown",function(r){k=!b.data(q.gridmenu[0],"contextMenuOpened"+q.gridmenu[0].id);d=b.data(document.body,"contextmenu"+q.element.id);if(d!=null){d=d.column.datafield}});var o=function(){var u=h.offset();var A=h.height();if(!k){k=true;if(d==n.datafield){q._closemenu();return false}}if(q.host.width()>parseInt(u.left)+q.gridmenu.width()){q.gridmenu.jqxMenu("open",u.left,u.top+A)}else{q.gridmenu.jqxMenu("open",h.width()+u.left-q.gridmenu.width(),u.top+A)}q._hasOpenedMenu=true;var y=q._getmenuitembyindex(0);var r=q._getmenuitembyindex(1);var C=q._getmenuitembyindex(2);var z=q._getmenuitembyindex(3);var s=q._getmenuitembyindex(4);var D=q._getmenuitembyindex(5);if(y!=null&&r!=null&&C!=null){var v=n.sortable&&q.sortable;q.gridmenu.jqxMenu("disable",y.id,!v);q.gridmenu.jqxMenu("disable",r.id,!v);q.gridmenu.jqxMenu("disable",C.id,!v);if(n.datafield){if(q.sortcolumn==n.datafield){var w=q.getsortinformation();if(v){if(w.sortdirection.ascending){q.gridmenu.jqxMenu("disable",y.id,true)}else{q.gridmenu.jqxMenu("disable",r.id,true)}}}else{q.gridmenu.jqxMenu("disable",C.id,true)}}}if(z!=null&&s!=null){if(!q.groupable||!n.groupable){q.gridmenu.jqxMenu("disable",s.id,true);q.gridmenu.jqxMenu("disable",z.id,true)}else{if(q.groups&&q.groups.indexOf(n.datafield)!=-1){q.gridmenu.jqxMenu("disable",z.id,true);q.gridmenu.jqxMenu("disable",s.id,false)}else{q.gridmenu.jqxMenu("disable",z.id,false);q.gridmenu.jqxMenu("disable",s.id,true)}}}if(D!=null){q._updatefilterpanel(q,D,n);var t=0;if(q.sortable&&q._togglesort){t+=3}if(q.groupable&&q.addgroup){t+=2}var B=t*27+3;if(q.filterable){if(!n.filterable){q.gridmenu.height(B);b(q.filteritem).css("display","none")}else{q.gridmenu.height(B+176);b(q.filteritem).css("display","block")}}}b.data(document.body,"contextmenu"+q.element.id,{column:n,columnsmenu:h[0]})};q.addHandler(g,"click",function(r){p();o();return false});q.addHandler(h,"click",function(r){o();return false})},_rendercolumnheader:function(e,f){var d=b('<a style="float: '+f+';" href="#">'+e+"</a>");return d},_renderrows:function(d){var e=this;if(this.pageable&&this.autoheight){if(this.table!=null&&this.table[0].rows!=null&&this.table[0].rows.length!=this.dataview.rows.length){e.prerenderrequired=true}}e._prerenderrows(d);if(e._requiresupdate){e._requiresupdate=false;e._updatepageviews()}if(this.virtualmode){var f=function(){if(e.rendergridrows){var l=e._startboundindex;if(l==undefined){l=0}var h=l+1+e.dataview.pagesize;if(l!=null&&h!=null){var k=e.source._source?true:false;var n=!k?e.source.recordstartindex:e.source._source.recordstartindex;if(n!=l){if(!k){e.source.recordstartindex=l;e.source.recordendindex=h}else{e.source._source.recordstartindex=l;e.source._source.recordendindex=h}e.updatebounddata()}}}};if(this.loadondemand){f();this.loadondemand=false}e._rendervisualrows()}else{if(navigator&&navigator.userAgent.indexOf("Chrome")==-1&&navigator.userAgent.indexOf("Safari")!=-1){this.updatedelay=1}if(this.updatedelay==0){e._rendervisualrows()}else{var g=b.data(document.body,"Grid"+this.element.id);if(g!=null){clearTimeout(g)}if(this.vScrollInstance.isScrolling()||this.hScrollInstance.isScrolling()){g=setTimeout(function(){e._rendervisualrows()},this.updatedelay);b.data(document.body,"Grid"+this.element.id,g)}else{b.data(document.body,"Grid"+this.element.id,null);e._rendervisualrows()}}}},_renderhorizontalscroll:function(){var k=this.hScrollInstance;var n=k.value;var f=parseInt(n);if(this.table==null){return}var r=this.table[0].rows.length;var q=this.columnsrow;var l=this.groupable&&this.groups.length>0?this.groups.length:0;var p=this.columns.records.length-l;var h=this.columns.records;for(i=0;i<r;i++){var d=this.table[0].rows[i];for(j=0;j<l+p;j++){var e=d.cells[j];if(e!=undefined){var g=h[j];if(!g.pinned){e.style.marginLeft=-f+"px";if(i==0){var o=q[0].cells[j];o.style.marginLeft=-f+"px"}}}}}if(this.editcell&&!this.editrow){if(this._showcelleditor&&this.editcell.editing){this._showcelleditor(this.editcell.row,this.getcolumn(this.editcell.column),this.editcell.element,this.editcell.init)}}},_updaterowdetailsvisibility:function(){if(this.rowdetails){for(i=0;i<this._rowdetailselementscache.length;i++){b(this._rowdetailselementscache[i]).css("display","none")}}},_getvisualcolumnsindexes:function(e,n,h,l,d){if(this.rowdetails){return{start:0,end:h+l}}var f=0;var k=-1;var g=h+l;var o=false;if(!d){for(j=0;j<h+l;j++){var p=j;if(!o){if(this.columns.records[j].pinned){o=true}}f+=this.columns.records[j].width;if(f>=e&&k==-1){k=j}if(f>n+e){g=j;break}}}g++;if(g>h+l){g=h+l}if(k==-1||o){k=0}return{start:k,end:g}},_rendervisualrows:function(){var N=this.vScrollInstance;var n=this.hScrollInstance;var f=N.value;var w=n.value;var l=parseInt(f);var h=parseInt(w);var u=this._gettableheight();var D=this.host.width();var y=this.groupable&&this.groups.length>0;this.visiblerows=new Array();this.hittestinfo=new Array();if(this.editcell&&this.editrow==undefined){this._hidecelleditor()}if(this.virtualmode&&!this.pageable){this._pagescache=new Array()}if(this._pagescache.length==0){this.dataview.updateview();this._loadrows()}if(this.vScrollBar.css("visibility")!="visible"){l=0}if(!this.pageable){var F=this._findvisiblerow(l,this._pageviews);if(F==-1){this._clearvisualrows();return}if(F!=this.dataview.pagenum){this.dataview.pagenum=F;this.dataview.updateview();this._loadrows()}else{if(!this._pagescache[this.dataview.pagenum]){this._loadrows()}}}var W=this.groupable&&this.groups.length>0?this.groups.length:0;var p=this.columns.records.length-W;var Q=this._findvisiblerow(l,this._pagescache[this.dataview.pagenum]);var G=this._pagescache[this.dataview.pagenum];var K=Q;if(K<0){K=0}var S=0;var P=0;var J=0;var e=0;var L=this.virtualsizeinfo.visiblerecords;var I=this.groupable?this.groups.length:0;var v=this.toTP("jqx-grid-cell");if(y){v=" "+this.toTP("jqx-grid-group-cell")}var H=this.rowsheight;var B=K;var V=this._rendercell;var q=true;var o=this._getvisualcolumnsindexes(h,D,W,p,y);var d=o.start;var O=o.end;if(K>=0){this._updaterowdetailsvisibility();this._startboundindex=G!=null?G[K].bounddata.boundindex:0;for(renderindex=0;renderindex<L&&P<L;renderindex++){var R=G!=undefined?G[K+renderindex]:null;if(R==null){K=-renderindex;if(this._pagescache[this.dataview.pagenum+1]){G=this._pagescache[this.dataview.pagenum+1];this.dataview.pagenum++}else{var r=this._pageviews.length;do{if(this.dataview.pagenum<this._pageviews.length-1){this.dataview.pagenum++;G=undefined;if(this._pageviews[this.dataview.pagenum].height>0){this.dataview.updateview();this._loadrows();G=this._pagescache[this.dataview.pagenum]}}else{G=undefined;break}}while(G==undefined&&this.dataview.pagenum<r)}if(G!=undefined){R=G[K+renderindex]}}if(R!=null){if(R.hidden){continue}if(renderindex==0){var k=Math.abs(l-R.top);this.table.css("top",-k);e=-k}var g=this.table[0].rows[P];var C=b(g);if(parseInt(g.style.height)!=R.height){C.height(R.height)}J+=R.height;var M=this.rowdetails&&R.rowdetails;var t=!R.rowdetailshidden;if(M&&t){C.height(R.height-R.rowdetailsheight);L++}var E=this._isrowselected(q,R);for(cindex=d;cindex<O;cindex++){var T=cindex;this._rendervisualcell(V,v,E,M,t,y,I,g,R,T,P)}if(R.group!=undefined&&this._rendergroup){this._rendergroup(I,g,R,W,p,P)}this.visiblerows[this.visiblerows.length]=R;this.hittestinfo[this.hittestinfo.length]={row:R,visualrow:g,details:false};if(M&&t){P++;var g=this.table[0].rows[P];this._renderrowdetails(v,g,R,W,p,P);this.visiblerows[this.visiblerows.length]=R;this.hittestinfo[this.hittestinfo.length]={row:R,visualrow:g,details:true}}if(J+e>=u){break}}else{cansetheight=true;this._clearvisualrow(h,y,P,W,p);if(J+S+parseInt(this.table.css("top"))<=u){S+=H}}P++}this._horizontalvalue=h;if(S>0){if(this.vScrollBar.css("visibility")=="visible"){var U=parseInt(this.table.css("top"));var A=this._pageviews[this._pageviews.length-1];var s=N.max;var z=A.top+A.height-u;if(this.hScrollBar.css("visibility")=="visible"){z+=6}if(s!=z){N.max=z;N.setPosition(N.max)}}}}},_clearvisualrows:function(){var e=this.virtualsizeinfo.visiblerecords;var f=this.hScrollInstance;var d=f.value;var g=parseInt(d);var h=this.groupable&&this.groups.length>0;for(renderindex=0;renderindex<e;renderindex++){this._clearvisualrow(g,h,renderindex,0,this.columns.records.length)}},_isrowselected:function(f,e){var d=false;if(f&&e.bounddata!=null){if(this.selectionmode!="singlerow"){if(this.selectedrowindexes.indexOf(e.bounddata.boundindex)!=-1){d=true}}else{if(e.bounddata.boundindex==this.selectedrowindex){d=true}}}return d},_rendervisualcell:function(A,k,q,n,t,y,l,r,d,h,s){var f=null;var g=this.columns.records[h];cellvalue=this._getcellvalue(g,d);var e=r.cells[h];var w=k;if(g.cellclassname!=""&&g.cellclassname){w+=" "+g.cellclassname}if(this.selectionmode.indexOf("cell")!=-1){if(this.selectedcells[d.boundindex+"_"+g.datafield]){q=true}else{q=false}}var p=this.showsortcolumnbackground&&this.sortcolumn&&g.datafield==this.sortcolumn;if(p){w+=" "+this.toTP("jqx-grid-cell-sort")}if(g.filter&&this.showfiltercolumnbackground){w+=" "+this.toTP("jqx-grid-cell-filter")}if(g.pinned&&this.showpinnedcolumnbackground){w+=" "+this.toTP("jqx-grid-cell-pinned")}if(this.altrows&&d.group==undefined){var z=d.visibleindex;if(z>=this.altstart){if((this.altstart+z)%(1+this.altstep)==0){if(!p){w+=" "+this.toTP("jqx-grid-cell-alt")}else{w+=" "+this.toTP("jqx-grid-cell-sort-alt")}if(g.filter&&this.showfiltercolumnbackground){w+=" "+this.toTP("jqx-grid-cell-filter-alt")}if(g.pinned&&this.showpinnedcolumnbackground){w+=" "+this.toTP("jqx-grid-cell-pinned-alt")}}}}if(h<=l){if(y||this.rowdetails){var u=b(e);var o=this.columns.records[h].width;if(parseInt(e.style.width)!=o){u.width(o)}}}var v=true;if(this.rowdetails&&n){if(t&&!y){w+=" "+this.toTP("jqx-grid-details-cell")}else{if(y){w+=" "+this.toTP("jqx-grid-group-details-cell")}}if(this.showrowdetailscolumn){if(d.group==undefined&&h==l){if(t){w+=" "+this.toTP("jqx-grid-group-expand")}else{w+=" "+this.toTP("jqx-grid-group-collapse")}v=false}}}if(q&&v){w+=" "+this.toTP("jqx-grid-cell-selected")}if(e.className!=w){e.className=w}if(d.group!=undefined){cellvalue="";e.title="";e.innerHTML="";return}A(this,g,d,cellvalue,e)},_rendercell:function(l,f,p,o,e){var g=p.uniqueid+"_"+f.visibleindex;if(l.editcell&&!l.editrow){if(l.editcell.row==p.boundindex&&l.editcell.column==f.datafield){l.editcell.element=e;if(l.editcell.editing){if(l._showcelleditor){l._showcelleditor(l.editcell.row,f,l.editcell.element,l.editcell.init);return}}}}else{if(l.editrow){if(l.editrow==p.boundindex){l.editcells[f.datafield].element=e;if(l.editcells[f.datafield].editing){if(l._showcelleditor){l._showcelleditor(l.editcells[f.datafield].row,f,e,l.editcells[f.datafield].init);return}}}}}if(l._cellscache[g]){if(f.columntype=="checkbox"){if(l.host.jqxCheckBox){if(o==""){o=false}var h=e.innerHTML.toString().length==0;if(e.checkbox&&!l.groupable&&!h){e.checkboxrow=p.boundindex;e.checkbox.jqxCheckBox({checked:o})}else{l._rendercheckboxcell(l,e,f,p,o)}return}}else{if(f.columntype=="button"){if(l.host.jqxButton){if(o==""){o=false}if(f.cellsrenderer!=null){o=f.cellsrenderer(p.boundindex,f.datafield,o,n,f.getcolumnproperties())}if(e.button&&!l.groupable){e.buttonrow=p.boundindex;e.button.val(o)}else{l._renderbuttoncell(l,e,f,p,o)}return}}}var k=l._cellscache[g];var d=k.element;if(e.innerHTML.toLowerCase()!=d.toLowerCase()){e.innerHTML=d;if(l.enabletooltips){e.title=k.title}}return}if(l.enabletooltips){if(f.cellsformat!=""){if(b.jqx.dataFormat){if(b.jqx.dataFormat.isNumber(o)){o=b.jqx.dataFormat.formatnumber(o,f.cellsformat,l.gridlocalization)}else{if(b.jqx.dataFormat.isDate(o)){o=b.jqx.dataFormat.formatdate(o,f.cellsformat,l.gridlocalization)}}}}e.title=o}if(f.columntype=="checkbox"){l._rendercheckboxcell(l,e,f,p,o);l._cellscache[g]={element:"",title:o};return}else{if(f.columntype=="button"){if(f.cellsrenderer!=null){o=f.cellsrenderer(p.boundindex,f.datafield,o,n,f.getcolumnproperties())}l._renderbuttoncell(l,e,f,p,o);l._cellscache[g]={element:"",title:o};return}else{if(f.columntype=="number"){o=p.visibleindex}}}var n=l._defaultcellsrenderer(o,f);var d=null;if(f.cellsrenderer!=null){d=f.cellsrenderer(p.boundindex,f.datafield,o,n,f.getcolumnproperties())}else{d=n}if(d==null){d=n}l._cellscache[g]={element:d,title:o};e.innerHTML=d;return true},_rendercheckboxcell:function(f,d,e,l,g){if(f.host.jqxCheckBox){var k=b(d);if(g==""){g=false}if(g=="1"){g=true}if(g=="0"){g=false}if(g==1){g=true}if(g==0){g=false}if(k.find(".jqx-checkbox").length==0){d.innerHTML='<div tabIndex=0 style="opacity: 0.99; position: absolute; top: 50%; left: 50%; margin-top: -7px; margin-left: -10px;"></div>';b(d.firstChild).jqxCheckBox({enableContainerClick:false,animationShowDelay:0,animationHideDelay:0,locked:true,theme:f.theme,checked:g});if(this.editable&&e.editable){b(d.firstChild).jqxCheckBox({locked:false})}d.checkbox=b(d.firstChild);d.checkboxrow=l.boundindex;var h=b.data(d.firstChild,"jqxCheckBox").instance;h.updated=function(p,o){if(e.editable){var q=f.table[0].rows.length;var r=f._getcolumnindex(e.datafield);for(currentCheckbox=0;currentCheckbox<q;currentCheckbox++){var n=f.table[0].rows[currentCheckbox].cells[r].firstChild;b(n).jqxCheckBox("destroy")}if(f.editcell&&f.editcell.validated==false){f.setcellvalue(d.checkboxrow,e.datafield,!o,true)}else{f._raiseEvent(17,{rowindex:d.checkboxrow,datafield:e.datafield,value:!o,columntype:e.columntype});f.setcellvalue(d.checkboxrow,e.datafield,o,true);f._raiseEvent(18,{rowindex:d.checkboxrow,datafield:e.datafield,oldvalue:!o,value:o,columntype:e.columntype})}}}}else{d.checkboxrow=l.boundindex;b(d.firstChild).jqxCheckBox({checked:g})}}},_renderbuttoncell:function(f,d,e,k,g){if(f.host.jqxButton){var h=b(d);if(g==""){g=false}if(h.find(".jqx-button").length==0){d.innerHTML='<input type="button" style="opacity: 0.99; position: absolute; top: 0%; left: 0%; padding: 0px; margin-top: 2px; margin-left: 2px;"/>';b(d.firstChild).val(g);b(d.firstChild).attr("hideFocus","true");b(d.firstChild).jqxButton({theme:f.theme,height:f.rowsheight-4,width:e.width-4});d.button=b(d.firstChild);d.buttonrow=k.boundindex;b(d.firstChild).bind("click",function(l){if(e.buttonclick){e.buttonclick(d.buttonrow,l)}})}else{d.buttonrow=k.boundindex;b(d.firstChild).val(g)}}},_clearvisualrow:function(k,l,g,h,d){var e=this.toTP("jqx-grid-cell");if(l){e=" "+this.toTP("jqx-grid-group-cell")}for(j=0;j<h+d;j++){if(this.table[0].rows[g]){var f=this.table[0].rows[g].cells[j];f.className=e;if(this._horizontalvalue!=k&&!this.columns.records[j].pinned){b(f).css("margin-left",-k)}var n=this.columns.records[j].width;if(parseInt(f.style.width)!=n){b(f).width(n)}f.title="";f.innerHTML="";b(this.table[0].rows[g]).height(this.rowsheight)}}},_findgroupstate:function(e){var d=this._findgroup(e);if(d==null){return false}return d.expanded},_findgroup:function(e){var d=null;if(this.expandedgroups[e]){return this.expandedgroups[e]}return d},_clearcaches:function(){this._columnsbydatafield=new Array();this._pagescache=new Array();this._pageviews=new Array();this._cellscache=new Array();this.heights=new Array();this.hiddens=new Array();this.hiddenboundrows=new Array();this.heightboundrows=new Array();this.detailboundrows=new Array();this.details=new Array();this.expandedgroups=new Array();this._rowdetailscache=new Array();this._rowdetailselementscache=new Array();if(b.jqx.dataFormat){b.jqx.dataFormat.cleardatescache()}this.tableheight=null},_getColumnText:function(d){if(this._columnsbydatafield==undefined){this._columnsbydatafield=new Array()}if(this._columnsbydatafield[d]){return this._columnsbydatafield[d]}var e=d;b.each(this.columns.records,function(){if(this.datafield==d){e=this.text;return false}});this._columnsbydatafield[d]=e;return e},isscrollingvertically:function(){var d=(this.vScrollBar.jqxScrollBar("isScrolling"));return d},_renderrowdetails:function(q,v,d,u,o,y){var A=b(v);var g=0;var r=this.rowdetails&&this.showrowdetailscolumn?(1+this.groups.length)*this.groupindentwidth:(this.groups.length)*this.groupindentwidth;var e=b(v.cells[g]);e.css("width","100%");A.height(d.rowdetailsheight);e[0].className=q;var p=d.bounddata.boundindex;var l=p+"_";if(this._rowdetailscache[l]){var s=this._rowdetailscache[l];var z=s.html;if(this.initrowdetails){if(this._rowdetailscache[l].element){var f=this._rowdetailscache[l].element;var k=e.offset();var w=this.gridcontent.offset();var t=parseInt(k.top)-parseInt(w.top);var n=parseInt(k.left)-parseInt(w.left);b(f).css("top",t);b(f).css("left",n);b(f).css("display","block")}}else{e[0].innerHTML=z}return}e[0].innerHTML="";if(!this.enablerowdetailsindent){r=0}var h='<div style="overflow: hidden; width: 100%; height: 100%; margin-left: '+r+'px;">'+d.rowdetails+"</div>";this._rowdetailscache[l]={id:v.id,html:h};if(this.initrowdetails){var f=b(h)[0];b(this.gridcontent).prepend(b(f));b(f).css("position","absolute");b(f).width(this.host.width()-r);b(f).height(e.height());var k=e.offset();b(f).css("z-index",2000);if(this.isTouchDevice()){b(f).css("z-index",99999)}var k=e.offset();var w=this.gridcontent.offset();var t=parseInt(k.top)-parseInt(w.top);var n=parseInt(k.left)-parseInt(w.left);b(f).css("top",t);b(f).css("left",n);this.content[0].scrollTop=0;this.content[0].scrollLeft=0;this.initrowdetails(p,f);this._rowdetailscache[l].element=f;this._rowdetailselementscache[p]=f}else{e[0].innerHTML=h}},_defaultcellsrenderer:function(e,d){if(d.cellsformat!=""){if(!this.enabletooltips){if(b.jqx.dataFormat){if(b.jqx.dataFormat.isDate(e)){e=b.jqx.dataFormat.formatdate(e,d.cellsformat,this.gridlocalization)}else{if(b.jqx.dataFormat.isNumber(e)){e=b.jqx.dataFormat.formatnumber(e,d.cellsformat,this.gridlocalization)}}}}}return'<span style="margin: 4px; float: '+d.cellsalign+';">'+e+"</span>"},_getcellvalue:function(d,f){var e=null;e=f.bounddata[d.datafield];if(e==null){e=""}return e},getcell:function(h,d){if(h==null||d==null){return null}var e=parseInt(h);var g=h;var f="";if(!isNaN(e)){g=this.getrowdata(e)}if(g!=null){f=g[d]}return this._getcellresult(f,h,d)},getrenderedcell:function(h,d){if(h==null||d==null){return null}var e=parseInt(h);var g=h;var f="";if(!isNaN(e)){g=this.getrenderedrowdata(e)}if(g!=null){f=g[d]}return this._getcellresult(f,h,d)},_getcellresult:function(n,q,e){var f=this.getcolumn(e);if(f==null||f==undefined){return null}var k=f.getcolumnproperties();var g=k.hidden;var d=k.width;var p=k.pinned;var h=k.cellsalign;var l=k.cellsformat;var o=this.getrowheight(q);if(o==false){return null}return{value:n,row:q,column:e,width:d,height:o,hidden:g,pinned:p,align:h,format:l}},setcellvalue:function(v,k,t,r){if(v==null||k==null){return false}var u=parseInt(v);var f=u;var q=v;if(!isNaN(u)){q=this.getrowdata(u)}var h=false;if(this.filterable&&this._initfilterpanel&&this.dataview.filters.length){h=true}var n="";if(q!=null&&q[k]!=t){n=q[k];q[k]=t;var l=this.getrenderedrowdata(u,true);l[k]=t;if(h){f=q.dataindex;this.dataview.cachedrecords[q.dataindex][k]=t}}else{this._renderrows(this.virtualsizeinfo);return false}if(this.sortcolumn&&this.dataview.sortby){var d=this.getsortinformation();this.dataview.clearsortdata();this.dataview.sortby(d.sortcolumn,d.sortdirection.ascending)}this._cellscache=new Array();if(this.source.updaterow){this.source.updaterow(f,q)}var e=this.getrowid(v);var p=this.vScrollInstance.value;if(r==true||r==undefined){var s=this;var o=function(){if(s.pageable&&s.updatepagerdetails){s.updatepagerdetails();if(s.autoheight){s._updatepageviews()}}};if(h){this.dataview.refresh();this.rendergridcontent(true,true);o()}else{if(this.sortcolumn){this.dataview.reloaddata();this.rendergridcontent(true,true);o()}else{if(this.groupable&&this.groups.length>0){this.dataview.reloaddata();this.render();var q=this.getrowdata(v);var l=this.getrenderedrowdata(u,true);var g=l.parentItem;this._setgroupstate(g,true,true)}else{this.dataview.updateview();this._renderrows(this.virtualsizeinfo)}}}}this.vScrollInstance.setPosition(p);this._raiseEvent(19,{rowindex:v,datafield:k,newvalue:t,oldvalue:n});return true},getcellvalue:function(h,d){if(h==null||d==null){return null}var e=parseInt(h);var g=h;if(!isNaN(e)){g=this.getrowdata(e)}if(g!=null){var f=g[d];return f}return null},getrowdata:function(d){if(d==undefined){d=0}if(this.virtualmode){var e=this.dataview.records[d];return e}else{if(d>=0&&d<this.dataview.bounditems.length){var e=this.dataview.records[d];return e}}return null},getrenderedrowdata:function(d,f){if(d==undefined){d=0}if(d>=0&&d<this.dataview.bounditems.length){if(this.groupable&&this.groups.length>0){var g=this.getrowvisibleindex(d);var e=this.dataview.loadedrecords[g]}else{var e=this.dataview.loadedrecords[d];if(this.pageable&&(f==undefined||f==false)){var e=this.dataview.loadedrecords[this.dataview.pagesize*this.dataview.pagenum+d]}}return e}return null},getrowid:function(d){if(d==undefined){d=0}if(d>=0&&d<this.dataview.bounditems.length){var e=this.dataview.bounditems[d].uid;return e}return null},updaterow:function(e,h,d){if(e!=undefined&&h!=undefined){var f=this.dataview.updaterow(e,h);var g=this.vScrollInstance.value;if(d==undefined||d==true){this._updateGridData()}if(this.source.updaterow){this.source.updaterow(e,h)}this.vScrollInstance.setPosition(g);return f}return false},_updateGridData:function(){var d=false;if(this.filterable&&this._initfilterpanel&&this.dataview.filters.length){d=true}if(d){this.dataview.refresh();this.render()}else{if(this.sortcolumn||(this.groupable&&this.groups.length>0)){this.dataview.reloaddata();this.render()}else{this._cellscache=new Array();this._pagescache=new Array();this._renderrows(this.virtualsizeinfo)}}},deleterow:function(d){if(d!=undefined){var e=this.dataview.deleterow(d);this.render();if(this.source.deleterow){this.source.deleterow(d)}return e}return false},addrow:function(e,g,d){if(g!=undefined){if(d==undefined){d="last"}var f=this.dataview.addrow(e,g,d);this.render();if(this.source.addrow){this.source.addrow(g.uid,g,d)}return f}return false},_findvisiblerow:function(g,h){if(g==undefined){g=parseInt(this.vScrollInstance.value)}var e=0;if(h==undefined||h==null){h=this.rows.records}var d=h.length;while(e<=d){mid=parseInt((e+d)/2);var f=h[mid];if(f==undefined){break}if(f.top>g&&f.top+f.height>g){d=mid-1}else{if(f.top<g&&f.top+f.height<g){e=mid+1}else{return mid;break}}}return -1},_updatecellwidths:function(){var f=this.virtualsizeinfo;var o=this;this.table=this.gridcontent.find("#contenttable"+this.element.id);var k=this.groupable&&this.groups.length>0;var p=0;var l=f.visiblerecords;if(this.pageable&&this.autoheight){l=this.dataview.pagesize;if(this.groupable){this.dataview.updateview();l=this.dataview.rows.length}}if(!this.pageable&&this.autoheight){l=this.dataview.totalrecords}if(this.rowdetails){l+=this.dataview.pagesize}var q=this.columns.records.length;for(i=0;i<l;i++){var d=this.table[0].rows[i];var r=d.cells;var h=0;for(j=0;j<q;j++){var g=this.columns.records[j];var e=g.width;var n=b(r[j]);n.css("left",h);n.width(e);n[0].left=h;if(!(g.hidden&&g.hideable)){h+=e}else{n.css("display","none")}}if(p==0){this.table.width(parseInt(h)+2);p=h}}this._updatescrollbarsafterrowsprerender()},_updatescrollbarsafterrowsprerender:function(){var d=this.hScrollBar.css("visibility");var f=0;if(this.vScrollBar.css("visibility")=="visible"){f=this.scrollbarsize+3}if(this.table.width()-2>this.host.width()-f){if(d!="visible"){this.hScrollBar.css("visibility","visible");this._arrange()}if(this.vScrollBar.css("visibility")=="visible"){var e=this.vScrollBar.jqxScrollBar("max");this.vScrollBar.jqxScrollBar("max",e+this.scrollbarsize+4)}this.hScrollBar.jqxScrollBar("max",f+this.table.width()-this.host.width())}else{if(d!="hidden"){this.hScrollBar.css("visibility","hidden");this._arrange()}}this._renderhorizontalscroll()},_prerenderrows:function(f){var q=this;if(this.prerenderrequired==true){this.prerenderrequired=false;if(this.editable&&this._destroyeditors){this._destroyeditors()}this.gridcontent.find("#contenttable"+this.element.id).remove();if(this.table!=null){this.table.remove();this.table=null}this.table=b('<div id="contenttable'+this.element.id+'" style="overflow: hidden; position: relative;" height="100%"></div>');this.gridcontent.addClass(this.toTP("jqx-grid-content"));this.gridcontent.append(this.table);var k=this.groupable&&this.groups.length>0;var r=0;this.table[0].rows=new Array();var t=799;var p=this.toTP("jqx-grid-cell");if(k){p=" "+this.toTP("jqx-grid-group-cell")}var n=f.visiblerecords;if(this.pageable&&this.autoheight){n=this.dataview.pagesize;if(this.groupable){this.dataview.updateview();n=this.dataview.rows.length}}if(!this.pageable&&this.autoheight){n=this.dataview.totalrecords}if(this.rowdetails){n+=this.dataview.pagesize}var s=this.columns.records.length;if(b.browser.msie&&b.browser.version>8){this.table.css("opacity","0.99")}var l=b.browser.msie&&b.browser.version<8;if(l){this.host.attr("hideFocus","true")}for(i=0;i<n;i++){var d=b('<div style="position: relative;" id="row'+i+this.element.id+'"></div>');var h=0;this.table[0].rows[i]=d[0];this.table[0].rows[i].cells=new Array();for(j=0;j<s;j++){var g=this.columns.records[j];var e=g.width;if(e<g.minwidth){e=g.minwidth}if(e>g.maxwidth){e=g.maxwidth}var o=b('<div style="overflow: hidden; position: absolute; height: 100%;" class="'+p+'"></div>');d.append(o);o.css("left",h);o.css("z-index",t--);o.width(e);o[0].left=h;if(!(g.hidden&&g.hideable)){h+=e}else{o.css("display","none")}this.table[0].rows[i].cells[j]=o[0]}if(l){d.css("z-index",t--)}if(r==0){this.table.width(parseInt(h)+2);r=h}this.table.append(d);d.height(this.rowsheight)}this._updatescrollbarsafterrowsprerender()}},_groupsheader:function(){return this.groupable&&this.showgroupsheader},_arrange:function(){var f=null;var v=null;this.tableheight=null;var q=this;if(this.width!=null&&this.width.toString().indexOf("px")!=-1){f=this.width}else{if(this.width!=undefined&&!isNaN(this.width)){f=this.width}}if(this.height!=null&&this.height.toString().indexOf("px")!=-1){v=this.height}else{if(this.height!=undefined&&!isNaN(this.height)){v=this.height}}var h=function(){var y=0;var z=q.showheader?q.columnsheader!=null?q.columnsheader.height()+2:0:0;y+=z;if(q.pageable){y+=q.pagerheight}if(q._groupsheader()){y+=q.groupsheaderheight}if(q.hScrollBar.css("visibility")=="visible"){y+=20}return y};if(this.autoheight&&this.virtualsizeinfo){if(this.pageable&&this.gotopage){var u=this.host.height()-this._gettableheight();v=u+this._pageviews[0].height;if(v==0){v=h()}}else{var u=this.host.height()-this._gettableheight();if(this._pageviews.length>0){v=u+this._pageviews[this._pageviews.length-1].height+this._pageviews[this._pageviews.length-1].top;this.vScrollBar.css("visibility","hidden")}}}else{if(this.autoheight){v=this.dataview.totalrecords*this.rowsheight;if(this._loading){v=250;this.dataloadelement.height(v)}v+=h();if(v>10000){v=10000}}}var t=this.host.css("border-width");if(t==null){t=0}if(f!=null){f=parseInt(f);this.host.width(this.width)}else{this.host.width(250)}if(v!=null){v=parseInt(v);this.host.height(v)}else{this.host.height(250)}if(this.autoheight){this.tableheight=null;this._gettableheight()}var s=0;if(this._groupsheader()){this.groupsheader.width(f);this.groupsheader.height(this.groupsheaderheight);this.groupsheader.css("top",0);var g=this.groupsheader.height()+1;s=g;if(v>g){v-=parseInt(g)}}else{this.groupsheader.width(f);this.groupsheader.height(this.groupsheaderheight);this.groupsheader.css("top",0);this.content.css("top",this.groupsheader.height())}var d=this.scrollbarsize;if(isNaN(d)){d=parseInt(d);if(isNaN(d)){d="17px"}else{d=d+"px"}}d=parseInt(d);var o=4;var w=2;var r=0;if(this.vScrollBar.css("visibility")=="visible"){r=d+o}if(this.hScrollBar.css("visibility")=="visible"){w=d+o+2}var e=0;if(this.pageable){e=this.pagerheight;w+=this.pagerheight}this.hScrollBar.height(d);this.hScrollBar.css({top:s+v-o-d-e+"px",left:"0px"});this.hScrollBar.width(f-d-o+"px");if(r==0){this.hScrollBar.width(f-2)}this.vScrollBar.width(d);this.vScrollBar.height(parseInt(v)-w+"px");this.vScrollBar.css({left:parseInt(f)-parseInt(d)-o+"px",top:s});var n=this.vScrollInstance;n.disabled=this.disabled;n.refresh();var k=this.hScrollInstance;k.disabled=this.disabled;k.refresh();if((this.vScrollBar.css("visibility")=="visible")&&(this.hScrollBar.css("visibility")=="visible")){this.bottomRight.css("visibility","visible");this.bottomRight.css({left:1+parseInt(this.vScrollBar.css("left")),top:parseInt(this.hScrollBar.css("top"))});this.bottomRight.width(parseInt(d)+3);this.bottomRight.height(parseInt(d)+4)}else{this.bottomRight.css("visibility","hidden")}this.content.width(f-r);this.content.height(v-w+2);this.content.css("top",s);if(this.pageable){this.pager.width(f);this.pager.height(this.pagerheight);this.pager.css("top",s+v-this.pagerheight)}else{this.pager.height(0)}if(this.table!=null){var l=0;if(this.vScrollBar.css("visibility")=="visible"){l=this.scrollbarsize+3}var p=l+this.table.width()-this.host.width();this.hScrollBar.jqxScrollBar("max",p);if(this.hScrollBar.css("visibility")=="visible"&&p==0){this.hScrollBar.css("visibility","hidden");this._arrange()}}},destroy:function(){if(this.host.jqxDropDownList){var g=b(b.find("#filterclearbutton"+this.element.id));var f=b(b.find("#filterbutton"+this.element.id));var l=b(b.find("#filter1"+this.element.id));var e=b(b.find("#filter2"+this.element.id));var k=b(b.find("#filter3"+this.element.id));var h=b(b.find(".filtertext1"+this.element.id));var d=b(b.find(".filtertext2"+this.element.id));if(h.length>0&&d.length>0){h.removeClass();d.removeClass();h.remove();d.remove()}this.removeHandler(g,"click");this.removeHandler(f,"click");l.jqxDropDownList("destroy");e.jqxDropDownList("destroy");k.jqxDropDownList("destroy")}if(this.host.jqxMenu){if(this.gridmenu){this.removeHandler(b(document),"click.menu"+this.element.id);this.removeHandler(this.gridmenu,"keydown");this.removeHandler(this.gridmenu,"closed");this.removeHandler(this.gridmenu,"itemclick");this.gridmenu.jqxMenu("destroy");this.gridmenu.remove()}}if(this.pagershowrowscombo){this.pagershowrowscombo.jqxDropDownList("destroy")}if(this.pagerrightbutton){this.removeHandler(this.pagerrightbutton,"mousedown");this.removeHandler(this.pagerrightbutton,"mouseup");this.removeHandler(this.pagerrightbutton,"click");this.pagerrightbutton.jqxButton("destroy")}if(this.pagerleftbutton){this.removeHandler(this.pagerleftbutton,"mousedown");this.removeHandler(this.pagerleftbutton,"mouseup");this.removeHandler(this.pagerleftbutton,"click");this.pagerleftbutton.jqxButton("destroy")}this.removeHandler(b(document),"mousedown.resize"+this.element.id);this.removeHandler(b(document),"mouseup.resize"+this.element.id);this.removeHandler(b(document),"mousemove.resize"+this.element.id);this.columns=new b.jqx.collection(this.element);this.rows=new b.jqx.collection(this.element);this.hScrollInstance.destroy();this.vScrollInstance.destroy();this.hScrollBar.remove();this.vScrollBar.remove();this._removeHandlers();this._clearcaches();this.dataview._clearcaches();this.content.remove();this.host.remove()},_initializeColumns:function(){var g=this;var d=new b.jqx.collection(this.element);var f=0;if(!this._columns){this._columns=this.columns}else{this.columns=this._columns}if(this.groupable){b.each(this.groups,function(h){var k=new c(g,this);k.visibleindex=f++;k.width=g.groupindentwidth;d.add(k)})}if(this.rowdetails&&this.showrowdetailscolumn){var e=new c(g,this);e.visibleindex=f++;e.width=g.groupindentwidth;e.pinned=true;d.add(e)}b.each(this.columns,function(h){var k=new c(g,this);if(!k.hidden||(k.hidden&&!k.hideable)){k.visibleindex=f++;d.add(k)}});this.columns=d},_initializeRows:function(){var d=new b.jqx.collection(this.element);this.rows=d},_raiseEvent:function(h,e){if(e==undefined){e={owner:null}}var f=this.events[h];args=e;args.owner=this;var g=new jQuery.Event(f);g.owner=this;g.args=args;var d=this.host.trigger(g);e=g.args;return d},wheel:function(f,e){var g=0;if(!f){f=window.event}if(f.originalEvent&&f.originalEvent.wheelDelta){f.wheelDelta=f.originalEvent.wheelDelta}if(f.wheelDelta){g=f.wheelDelta/120}else{if(f.detail){g=-f.detail/3}}if(g){var d=e._handleDelta(g);if(f.preventDefault){f.preventDefault()}if(f.originalEvent!=null){f.originalEvent.mouseHandled=true}if(f.stopPropagation!=undefined){f.stopPropagation()}if(d){d=false;f.returnValue=d;return d}else{return false}}if(f.preventDefault){f.preventDefault()}f.returnValue=false},_handleDelta:function(f){var e=this.vScrollInstance.value;if(f<0){this.scrollDown()}else{this.scrollUp()}var d=this.vScrollInstance.value;if(e!=d){return true}return false},scrollDown:function(){if(this.vScrollBar.css("visibility")=="hidden"){return}var d=this.vScrollInstance;if(d.value+this.rowsheight<=d.max){d.setPosition(parseInt(d.value)+this.rowsheight)}else{d.setPosition(d.max)}},scrollUp:function(){if(this.vScrollBar.css("visibility")=="hidden"){return}var d=this.vScrollInstance;if(d.value-this.rowsheight>=d.min){d.setPosition(parseInt(d.value)-this.rowsheight)}else{d.setPosition(d.min)}},_removeHandlers:function(){var d=this;this.removeHandler(this.vScrollBar,"valuechanged");this.removeHandler(this.hScrollBar,"valuechanged");this.removeHandler(this.host,"mousedown");this.removeHandler(this.content,"mousemove");this.removeHandler(this.host,"mouseleave");this.removeHandler(this.content,"mouseenter");this.removeHandler(this.content,"mouseleave");this.removeHandler(this.content,"selectstart."+this.element.id);this.removeHandler(this.host,"dragstart."+this.element.id);this.removeHandler(this.host,"keydown.edit"+this.element.id);this.removeHandler(b(document),"keydown.edit"+this.element.id);this.removeHandler(b(document),"mousemove.selection"+this.element.id);this.removeHandler(b(document),"mouseup.selection"+this.element.id)},_addHandlers:function(){var d=this;this.addHandler(this.host,"dragstart."+this.element.id,function(f){return false});this.vScrollInstance.valuechanged=function(f){d._closemenu();d._renderrows(d.virtualsizeinfo);if(!d.pageable&&!d.groupable&&d.dataview.virtualmode){if(d.loadondemandupdate){clearTimeout(d.loadondemandupdate)}d.loadondemandupdate=setTimeout(function(){d.loadondemand=true;d._renderrows(d.virtualsizeinfo)},100)}};this.hScrollInstance.valuechanged=function(f){d._closemenu();if(navigator&&navigator.userAgent.indexOf("Safari")!=-1){setTimeout(function(){d._renderhorizontalscroll();d._renderrows(d.virtualsizeinfo);if(d.editcell&&!d.editrow){if(d._showcelleditor&&d.editcell.editing){d._showcelleditor(d.editcell.row,d.getcolumn(d.editcell.column),d.editcell.element,d.editcell.init)}}},1)}else{d._renderhorizontalscroll();d._renderrows(d.virtualsizeinfo);if(d.editcell&&!d.editrow){if(d._showcelleditor&&d.editcell.editing){d._showcelleditor(d.editcell.row,d.getcolumn(d.editcell.column),d.editcell.element,d.editcell.init)}}}};this._mousewheelfunc=this._mousewheelfunc||function(f){if(!d.editcell){d.wheel(f,d);return false}};this.removeHandler(this.host,"mousewheel",this._mousewheelfunc);this.addHandler(this.host,"mousewheel",this._mousewheelfunc);this.addHandler(this.host,"mousedown",function(f){d._handlemousedown(f,d)});this.addHandler(this.host,"dblclick",function(f){if(d.editable&&d.begincelledit&&d.editmode=="dblclick"){d._handledblclick(f,d)}d.mousecaptured=false;return true});this.addHandler(this.content,"mousemove",function(f){if(d._handlemousemove){return d._handlemousemove(f,d)}});this.addHandler(b(document),"mousemove.selection"+this.element.id,function(f){if(d._handlemousemoveselection){return d._handlemousemoveselection(f,d)}});this.addHandler(b(document),"mouseup.selection"+this.element.id,function(f){if(d._handlemouseupselection){d._handlemouseupselection(f,d)}});if(window.frameElement){if(window.top!=null){var e=function(f){if(d._handlemouseupselection){d._handlemouseupselection(f,d)}};if(window.top.document.addEventListener){window.top.document.addEventListener("mouseup",e,false)}else{if(window.top.document.attachEvent){window.top.document.attachEvent("onmouseup",e)}}}}this.focused=false;this.addHandler(this.content,"mouseenter",function(f){d.focused=true});this.addHandler(this.content,"mouseleave",function(f){if(d._handlemousemove){if(d.enablehover){d._clearhoverstyle()}}d.focused=false});this.addHandler(this.content,"selectstart."+this.element.id,function(f){if(!d.editcell){return false}});this.addHandler(b(document),"keydown.edit"+this.element.id,function(h){if(d.editable&&d.editcell){var g=h.charCode?h.charCode:h.keyCode?h.keyCode:0;if(g==13||g==27){if(d._handleeditkeydown){f=d._handleeditkeydown(h,d)}}}if(b.browser.msie&&d.focused&&!d.isNestedGrid){var f=true;if(f&&d.keyboardnavigation&&d._handlekeydown){f=d._handlekeydown(h,d);if(!f){if(h.preventDefault){h.preventDefault()}if(h.stopPropagation!=undefined){h.stopPropagation()}}return f}}return true});this.addHandler(this.host,"keydown.edit"+this.element.id,function(g){var f=true;if(d.editable&&d.editmode!="programmatic"){if(d._handleeditkeydown){f=d._handleeditkeydown(g,d)}}if(!b.browser.msie){if(f&&d.keyboardnavigation&&d._handlekeydown){f=d._handlekeydown(g,d)}}else{if(d.isNestedGrid){if(f&&d.keyboardnavigation&&d._handlekeydown){f=d._handlekeydown(g,d)}}}if(!f){if(g.preventDefault){g.preventDefault()}if(g.stopPropagation!=undefined){g.stopPropagation()}}return f})},_hittestrow:function(u,s){if(this.vScrollInstance==null||this.hScrollInstance==null){return}if(u==undefined){u=0}if(s==undefined){s==0}var n=this.vScrollInstance;var l=this.hScrollInstance;var e=n.value;if(this.vScrollBar.css("visibility")!="visible"){e=0}var o=l.value;if(this.hScrollBar.css("visibility")!="visible"){o=0}var t=parseInt(e)+s;var k=parseInt(o)+u;if(this.visiblerows==null){return}var h=this._findvisiblerow(t,this.visiblerows);if(h>=0){var q=this.visiblerows[h];var d=this.rowdetails&&q.rowdetails;var p=!q.rowdetailshidden;if(d){var f=this.visiblerows[h-1];if(f==q){q=f;h--}if(p){var g=b(this.hittestinfo[h].visualrow).position().top+parseInt(this.table.css("top"));var r=b(this.hittestinfo[h].visualrow).height();if(!(s>=g&&s<=g+r)){h++;q=this.visiblerows[h]}}}}return{index:h,row:q}},getCellAtPosition:function(k,s){var t=this;var A=this.showheader?this.columnsheader.height()+2:0;var u=this._groupsheader()?this.groupsheader.height():0;var g=this.host.offset();var r=k-g.left;var p=s-A-g.top-u;var d=this._hittestrow(r,p);var l=d.row;var n=d.index;var v=this.table[0].rows[n];if(this.dataview&&this.dataview.records.length==0){var q=this.table[0].rows;var C=0;for(i=0;i<q.length;i++){if(p>=C&&p<C+this.rowsheight){v=q[i];break}C+=this.rowsheight}l={boundindex:i}}if(v==null){return true}var w=this.hScrollInstance;var z=w.value;var f=0;var o=this.groupable?this.groups.length:0;for(i=0;i<v.cells.length;i++){var h=parseInt(b(this.columnsrow[0].cells[i]).css("left"));var k=h-z;if(t.columns.records[i].pinned){k=h}var B=k+b(this.columnsrow[0].cells[i]).width();if(B>=r&&r>=k){f=i;break}}if(l!=null){var e=this._getcolumnat(f);return{row:l.boundindex,column:e.datafield,value:this.getcellvalue(l.boundindex,e.datafield)}}return null},_handlemousedown:function(B,t){if(B.target==null){return true}if(t.disabled){return true}if(b(B.target).ischildof(this.columnsheader)){return true}var D;if(B.which){D=(B.which==3)}else{if(B.button){D=(B.button==2)}}if(D){return true}var G;if(B.which){G=(B.which==2)}else{if(B.button){G=(B.button==1)}}if(G){return true}var C=this.showheader?this.columnsheader.height()+2:0;var u=this._groupsheader()?this.groupsheader.height():0;var h=this.host.offset();var s=B.pageX-h.left;var r=B.pageY-C-h.top-u;var d=this._hittestrow(s,r);var o=d.row;var p=d.index;var w=B.target.className;var v=this.table[0].rows[p];if(v==null){return true}t.mousecaptured=true;t.mousecaptureposition={left:B.pageX,top:B.pageY-u};var z=this.hScrollInstance;var A=z.value;var g=0;var q=this.groupable?this.groups.length:0;for(i=0;i<v.cells.length;i++){var k=parseInt(b(this.columnsrow[0].cells[i]).css("left"));var l=k-A;if(t.columns.records[i].pinned){l=k}var F=l+b(this.columnsrow[0].cells[i]).width();if(F>=s&&s>=l){g=i;break}}if(o!=null){this._raiseEvent(1,{rowindex:o.boundindex,visibleindex:o.visibleindex,group:o.group});var f=this._getcolumnat(g);this._raiseEvent(8,{rowindex:o.boundindex,column:f?f.getcolumnproperties():null,datafield:f?f.datafield:null,columnindex:g});if(w.indexOf("jqx-grid-group-expand")!=-1||w.indexOf("jqx-grid-group-collapse")!=-1){if(q>0&&g<q&&this._togglegroupstate){this._togglegroupstate(o.bounddata,true)}else{if(g==q&&this.rowdetails&&this.showrowdetailscolumn){this._togglerowdetails(o.bounddata,true);this.gridcontent[0].scrollTop=0;this.gridcontent[0].scrollLeft=0}}}else{if(o.boundindex!=-1){var E=this.selectedrowindexes.slice(0);var n=false;if(t.selectionmode!="none"&&this._selectrowwithmouse){if(t.selectionmode=="multiplecellsextended"||t.selectonmode=="multiplerowsextended"){t.selectedrowindexes=new Array();t.selectedcells=new Array()}if(t.selectionmode.indexOf("cell")==-1){this._applyrowselection(o.boundindex,true,false,null,f.datafield);this._selectrowwithmouse(t,d,E,f.datafield)}else{this._selectrowwithmouse(t,d,E,f.datafield);this._applycellselection(o.boundindex,f.datafield,true,false)}if(t._oldselectedcell){if(t._oldselectedcell.datafield==t.selectedcell.datafield&&t._oldselectedcell.rowindex==t.selectedcell.rowindex){n=true}}t._oldselectedcell=t.selectedcell}if(t.editable&&t.begincelledit){var e=t.editmode=="click"||(n&&t.editmode=="selectedcell");if(t.selectionmode.indexOf("cell")==-1){e=true}if(e){if(o.boundindex!=undefined&&f.editable){t.begincelledit(o.boundindex,f.datafield,f.defaulteditorvalue)}}if(t.selectionmode.indexOf("cell")!=-1){if(t.editmode=="selectedcell"&&!n&&t.editcell){t.endcelledit(t.editcell.row,t.editcell.column,false,true)}}return false}}}}},_columnPropertyChanged:function(e,d,g,f){},_rowPropertyChanged:function(g,d,f,e){},propertyChangedHandler:function(d,e,g,f){if(this.isInitialized==undefined||this.isInitialized==false){return}switch(e){case"source":d.updatebounddata();break;case"horizontalscrollbarstep":case"verticalscrollbarstep":case"horizontalscrollbarlargestep":case"verticalscrollbarlargestep":this.vScrollBar.jqxScrollBar({step:this.verticalscrollbarstep,largestep:this.verticalscrollbarlargestep});this.hScrollBar.jqxScrollBar({step:this.horizontalscrollbarstep,largestep:this.horizontalscrollbarlargestep});break;case"closeablegroups":if(d._initgroupsheader){d._initgroupsheader()}break;case"showgroupsheader":d.rendergridcontent();break;case"theme":if(d.pager){d.pager.removeClass();d.pager.addClass(d.toTP("jqx-grid-pager"))}if(d.groupsheader){d.groupsheader.removeClass();d.groupsheader.addClass(d.toTP("jqx-grid-groups-header"))}d.vScrollBar.jqxScrollBar({theme:d.theme});d.hScrollBar.jqxScrollBar({theme:d.theme});d.host.removeClass();d.host.addClass(d.toTP("jqx-grid"));d.host.addClass(d.toTP("jqx-reset"));d.host.addClass(d.toTP("jqx-rc-all"));d.bottomRight.removeClass();d.bottomRight.addClass(d.toTP("jqx-grid-bottomright"));d.render();case"filterable":d.render();break;case"autoshowfiltericon":case"showfiltercolumnbackground":case"showpinnedcolumnbackground":case"showsortcolumnbackground":d.rendergridcontent();break;case"showrowdetailscolumn":d.render();break;case"scrollbarsize":d._arrange();break;case"theme":case"width":case"height":d.rendergridcontent(false);break;case"altrows":case"altstart":case"altstep":d._renderrows(d.virtualsizeinfo);break;case"groupsheaderheight":d._arrange();if(d._initgroupsheader){d._initgroupsheader()}break;case"pagerheight":d._initpager();break;case"selectedrowindex":d.selectrow(f);break;case"selectionmode":if(f=="none"){d.selectedrowindexes=new Array();d.selectedcells=new Array();d.selectedrowindex=-1}d._renderrows(d.virtualsizeinfo);break;case"showheader":if(f){d.columnsheader.css("display","block")}else{d.columnsheader.css("display","none")}break;case"virtualmode":d.dataview.virtualmode=d.virtualmode;d.dataview.refresh(false);d._render(false,false,false);break;case"columnsmenu":d.render();break;case"columns":d.render();break;case"autoheight":d._render(false,false,true);break;case"pagesizeoptions":case"pageable":case"pagesize":if(d._loading){alert(d.loadingerrormessage);return}if(d._initpager){d.dataview.pageable=d.pageable;d.dataview.pagenum=0;d.dataview.pagesize=d._getpagesize();if(d.virtualmode){d.updatebounddata()}d.dataview.refresh(true);d._initpager();if(e=="pagesizeoptions"){if(f!=null&&f.length>0){d.pagesize=f[0];d.dataview.pagesize=f[0];d.prerenderrequired=true;d._requiresupdate=true;d.dataview.pagenum=-1;d.gotopage(0)}}}d._render(false,false,false);break;case"groupable":d.dataview.groupable=d.groupable;d.dataview.pagenum=0;d.dataview.refresh(false);d._render(false,false,true);break}}});function c(d,e){this.owner=d;this.datafield=null;this.text="";this.sortable=true;this.hideable=true;this.editable=true;this.hidden=false;this.groupable=true;this.renderer=null;this.cellsrenderer=null;this.checkchange=null,this.buttonclick=null,this.columntype=null;this.cellsformat="";this.align="left";this.cellsalign="left";this.width="auto";this.minwidth=25;this.maxwidth="auto";this.pinned=false;this.visibleindex=-1;this.filterable=true;this.filter=null;this.resizable=true;this.initeditor=null;this.validation=null;this.classname="";this.cellclassname="";this.getcolumnproperties=function(){return{sortable:this.sortable,hideable:this.hideable,hidden:this.hidden,groupable:this.groupable,width:this.width,align:this.align,editable:this.editable,minwidth:this.minwidth,maxwidth:this.maxwidth,resizable:this.resizable,datafield:this.datafield,text:this.text,cellsalign:this.cellsalign,pinned:this.pinned,cellsformat:this.cellsformat,columntype:this.columntype,classname:this.classname,cellclassname:this.cellclassname}},this.setproperty=function(f,g){if(this[f]){var h=this[f];this[f]=g;this.owner._columnPropertyChanged(this,f,g,h)}};this._initfields=function(f){if(f!=null){if(f.datafield!=undefined){this.datafield=f.datafield}if(f.dataField!=undefined){this.datafield=f.dataField}if(f.text!=undefined){this.text=f.text}if(f.sortable!=undefined){this.sortable=f.sortable}if(f.hideable!=undefined){this.hideable=f.hideable}if(f.hidden!=undefined){this.hidden=f.hidden}if(f.groupable!=undefined){this.groupable=f.groupable}if(f.renderer!=undefined){this.renderer=f.renderer}if(f.align!=undefined){this.align=f.align}if(f.cellsalign!=undefined){this.cellsalign=f.cellsalign}if(f.cellsformat!=undefined){this.cellsformat=f.cellsformat}if(f.width!=undefined){this.width=f.width}if(f.minwidth!=undefined){this.minwidth=f.minwidth}if(f.maxwidth!=undefined){this.maxwidth=f.maxwidth}if(f.cellsrenderer!=undefined){this.cellsrenderer=f.cellsrenderer}if(f.columntype!=undefined){this.columntype=f.columntype}if(f.checkchange!=undefined){this.checkchange=f.checkchange}if(f.buttonclick!=undefined){this.buttonclick=f.buttonclick}if(f.pinned!=undefined){this.pinned=f.pinned}if(f.visibleindex!=undefined){this.visibleindex=f.visibleindex}if(f.filterable!=undefined){this.filterable=f.filterable}if(f.filter!=undefined){this.filter=f.filter}if(f.resizable!=undefined){this.resizable=f.resizable}if(f.editable!=undefined){this.editable=f.editable}if(f.initeditor!=undefined){this.initeditor=f.initeditor}if(f.validation!=undefined){this.validation=f.validation}if(f.classname!=undefined){this.classname=f.classname}if(f.cellclassname!=undefined){this.cellclassname=f.cellclassname}}};this._initfields(e);return this}function a(d,e){this.setdata=function(f){if(f!=null){this.bounddata=f;this.boundindex=f.boundindex;this.visibleindex=f.visibleindex;this.group=f.group;this.parentbounddata=f.parentItem;this.uniqueid=f.uniqueid;this.level=f.level}};this.setdata(e);this.parentrow=null;this.subrows=new Array();this.owner=d;this.height=25;this.hidden=false;this.rowdetails=null;this.rowdetailsheight=100;this.rowdetailshidden=true;this.top=-1;this.getrowinfo=function(){return{hidden:this.hidden,rowdetails:this.rowdetails,rowdetailsheight:this.rowdetailsheight,showdetails:!this.rowdetailshidden,height:this.height,index:this.visibleindex}};this.setrowinfo=function(f){this.hidden=f.hidden;this.rowdetails=f.rowdetails;this.rowdetailsheight=f.rowdetailsheight;this.rowdetailshidden=!f.showdetails;this.height=f.height};return this}b.jqx.collection=function(d){this.records=new Array();this.owner=d;this.updating=false;this.beginupdate=function(){this.updating=true};this.resumeupdate=function(){this.updating=false};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(f){var e=this.length;var g=Number(arguments[1])||0;g=(g<0)?Math.ceil(g):Math.floor(g);if(g<0){g+=e}for(;g<e;g++){if(g in this&&this[g]===f){return g}}return -1}}this._raiseEvent=function(e){var f=new jQuery.Event("collectionchanged");f.owner=this.owner;f.args=e;b(this.owner).trigger(f)};this.replace=function(f,e){this.records[f]=e;if(!this.updating){this._raiseEvent({type:"replace",element:e})}};this.isempty=function(e){if(this.records[e]==undefined){return true}return false};this.initialize=function(e){if(e<1){e=1}this.records[e-1]=-1};this.length=function(){return this.records.length};this.indexOf=function(e){return this.records.indexOf(e)};this.add=function(e){if(e==null){return false}this.records[this.records.length]=e;if(!this.updating){this._raiseEvent({type:"add",element:e})}return true};this.insertAt=function(f,e){if(f==null||f==undefined){return false}if(e==null){return false}if(f>=0){if(f<this.records.length){this.records.splice(f,0,e);if(!this.updating){this._raiseEvent({type:"insert",index:f,element:e})}return true}else{return this.add(e)}}return false};this.remove=function(f){if(f==null||f==undefined){return false}var e=this.records.indexOf(f);if(e!=-1){this.records.splice(e,1);if(!this.updating){this._raiseEvent({type:"remove",element:f})}return true}return false};this.removeAt=function(f){if(f==null||f==undefined){return false}if(f<0){return false}if(f<this.records.length){var e=this.records[f];this.records.splice(f,1);if(!this.updating){this._raiseEvent({type:"removeAt",index:f,element:e})}return true}return false};return this};b.jqx.dataview=function(){this.self=this;this.grid=null;this.uniqueId="id";this.records=[];this.rows=[];this.columns=[];this.groups=[];this.filters=new Array();this.updated=null;this.update=null;this.suspend=false;this.pagesize=0;this.pagenum=0;this.totalrows=0;this.totalrecords=0;this.groupable=true;this.loadedrecords=[];this.loadedrootgroups=[];this.loadedgroups=[];this.loadedgroupsByKey=[];this.virtualmode=true;this._cachegrouppages=new Array();this.source=null;this.changedrecords=new Array();this.rowschangecallback=null;this.suspendupdate=function(){this.suspend=true},this.isupdating=function(){return this.suspend},this.resumeupdate=function(d){this.suspend=false;if(d==undefined){d=true}this.refresh(d)},this.getrecords=function(){return this.records},this.clearrecords=function(){this.recordids=new Array()};this.databind=function(d,o){var p=d._source?true:false;var e=new b.jqx.dataAdapter(d,{autoBind:false});if(p){e=d;d=d._source}var g=function(u){e._options.virtualmode=u.virtualmode;e._options.totalrecords=u.totalrecords;e._options.originaldata=u.originaldata;e._options.recordids=u.recordids;e._options.cachedrecords=new Array();e._options.pagenum=u.pagenum;e._options.pageable=u.pageable;if(d.type!=undefined){e._options.type=d.type}if(d.formatdata!=undefined){e._options.formatData=d.formatdata}if(d.contenttype!=undefined){e._options.contentType=d.contenttype}if(d.async!=undefined){e._options.async=d.async}if(d.updaterow!=undefined){e._options.updaterow=d.updaterow}if(d.addrow!=undefined){e._options.addrow=d.addrow}if(d.deleterow!=undefined){e._options.deleterow=d.deleterow}if(u.pagesize==0){u.pagesize=10}e._options.pagesize=u.pagesize};var r=function(v){v.totalrecords=e.totalrecords;if(!v.virtualmode){v.originaldata=e.originaldata;v.records=e.records;v.recordids=e.recordids;v.cachedrecords=e.cachedrecords}else{var u={startindex:v.pagenum*v.pagesize,endindex:(v.pagenum*v.pagesize+v.pagesize)};if(d.recordstartindex){u.startindex=d.recordstartindex}if(d.recordendindex){u.endindex=d.recordendindex}else{if(!v.grid.pageable){u.endindex=u.startindex+100}}if(v.grid.rendergridrows){d.records=v.grid.rendergridrows(u)}if(!d.records){d.records=new Array()}if(d.records.length!=0){v.originaldata=d.records;v.records=d.records;v.cachedrecords=d.records}}};g(this);this.source=d;if(o!==undefined){uniqueId=o}var s=this;switch(d.datatype){case"local":case"array":default:if(d.localdata==null){d.localdata=[]}if(d.localdata!=null){e.dataBind();var q=function(u){r(s);if(u=="updateData"){s.refresh();s.grid._updateGridData()}else{if(d.recordstartindex&&this.virtualmode){s.updateview(d.recordstartindex,d.recordstartindex+s.pagesize)}else{s.refresh()}s.update()}};q();e.unbindBindingUpdate(s.grid.element.id);e.bindBindingUpdate(s.grid.element.id,q)}break;case"json":case"jsonp":case"xml":case"xhtml":case"script":case"text":case"csv":case"tab":if(d.localdata!=null){e.dataBind();var q=function(u){r(s);if(u=="updateData"){s.refresh();s.grid._updateGridData()}else{if(d.recordstartindex){s.updateview(d.recordstartindex,d.recordstartindex+s.pagesize)}else{s.refresh()}s.update()}};q();e.unbindBindingUpdate(s.grid.element.id);e.bindBindingUpdate(s.grid.element.id,q);return}var n={};var k=0;var t={};for(x=0;x<this.filters.length;x++){var l=this.filters[x].datafield;var f=this.filters[x].filter;var h=f.getfilters();t[l+"operator"]=f.operator;for(m=0;m<h.length;m++){h[m].datafield=l;t["filtervalue"+k]=h[m].value;t["filtercondition"+k]=h[m].condition;t["filteroperator"+k]=h[m].operator;t["filterdatafield"+k]=l;k++}}t.filterscount=k;t.groupscount=s.groups.length;for(x=0;x<s.groups.length;x++){t["group"+x]=s.groups[x]}groups:s.groups;b.extend(t,{sortdatafield:s.sortfield,sortorder:s.sortfielddirection,pagenum:s.pagenum,pagesize:s.grid.pagesize});if(e._options.data){b.extend(e._options.data,t)}else{if(d.data){b.extend(t,d.data)}e._options.data=t}var q=function(){r(s);if(d.recordstartindex){s.updateview(d.recordstartindex,d.recordstartindex+s.pagesize)}else{s.refresh()}s.update()};e.unbindDownloadComplete(s.grid.element.id);e.bindDownloadComplete(s.grid.element.id,q);e.dataBind()}};this.getid=function(g,e,f){if(b(g,e).length>0){return b(g,e).text()}if(g){if(g.toString().length>0){var d=b(e).attr(g);if(d!=null&&d.toString().length>0){return d}}}return f};this.getvaluebytype=function(g,d){var e=g;if(d.type=="date"){var f=new Date(g);if(f.toString()=="NaN"||f.toString()=="Invalid Date"){if(b.jqx.dataFormat){g=b.jqx.dataFormat.tryparsedate(g)}else{g=f}}else{g=f}if(g==null){g=e}}else{if(d.type=="float"){var g=parseFloat(g);if(isNaN(g)){g=e}}else{if(d.type=="int"){var g=parseInt(g);if(isNaN(g)){g=e}}else{if(d.type=="bool"){if(g!=null){if(g.toLowerCase()=="false"){g=false}else{if(g.toLowerCase()=="true"){g=true}}}if(g==1){g=true}else{if(g==0){g=false}else{g=""}}}}}}return g};this.setpaging=function(d){if(d.pageSize!=undefined){this.pagesize=d.pageSize}if(d.pageNum!=undefined){this.pagenum=Math.min(d.pageNum,Math.ceil(this.totalrows/this.pagesize))}this.refresh()};this.getpagingdetails=function(){return{pageSize:this.pagesize,pageNum:this.pagenum,totalrows:this.totalrows}};this._clearcaches=function(){this.sortcache={};this.sortdata=[];this.changedrecords=new Array();this.records=new Array();this.cacheddata=new Array();this.originaldata=new Array();this.bounditems=new Array();this.loadedrecords=new Array();this.loadedrootgroups=new Array();this.loadedgroups=new Array();this.loadedgroupsByKey=new Array();this._cachegrouppages=new Array();this.recordsbyid={}};this.addfilter=function(f,e){var d=-1;for(m=0;m<this.filters.length;m++){if(this.filters[m].datafield==f){d=m;break}}if(d==-1){this.filters[this.filters.length]={filter:e,datafield:f}}else{this.filters[d]={filter:e,datafield:f}}};this.removefilter=function(d){for(i=0;i<this.filters.length;i++){if(this.filters[i].datafield==d){this.filters.splice(i,1);break}}};this.getItemFromIndex=function(d){return this.records[d]};this.updaterow=function(e,g){if(g!=undefined&&e!=undefined){g.uid=e;if(!(g[this.source.id])){g[this.source.id]=g.uid}var d=this.recordsbyid["id"+e];var f=this.records.indexOf(d);this.records[f]=g;this.refresh();this.changedrecords[g.uid]={Type:"Update",OldData:d,Data:g};return true}return false};this.addrow=function(g,h,d){if(h!=undefined){if(!g){h.uid=this.getid(this.source.id,h,this.totalrecords);var e=this.recordsbyid["id"+h.uid];while(e!=null){var f=Math.floor(Math.random()*10000).toString();h.uid=f;e=this.recordsbyid["id"+f]}}else{h.uid=g}if(!(h[this.source.id])){h[this.source.id]=h.uid}if(d=="last"){this.records.push(h)}else{this.records.splice(0,0,h)}this.totalrecords++;this.refresh();this.changedrecords[h.uid]={Type:"New",Data:h};return true}return false};this.deleterow=function(e){if(e!=undefined){if(this.recordsbyid["id"+e]){var d=this.recordsbyid["id"+e];var f=this.records.indexOf(d);this.changedrecords[e]={Type:"Delete",Data:this.records[f]};this.records.splice(f,1);this.totalrecords--;this.refresh();return true}return false}return false};this.reload=function(f,d,u,g,h,y,w){var p=this;var o=new Array();var r=f;var k=d;var l=u;var s=g;var n=k.length;var A=0;var e=0;var v,q;this.columns=[];this.bounditems=new Array();this.loadedrecords=new Array();this.loadedrootgroups=new Array();this.loadedgroups=new Array();this.loadedgroupsByKey=new Array();this._cachegrouppages=new Array();this.recordsbyid={};if(this.totalrecords==0){Object.size=function(D){var C=0,B;for(B in D){if(D.hasOwnProperty(B)){C++}}return C};var z=Object.size(r);this.totalrecords=z;b.each(this.records,function(C){var D=this;var B=0;b.each(D,function(E,F){p.columns[B++]=E});return false})}if(this.virtualmode){if(this.pageable){this.updateview();return}var y=0;if(!this.groupable){this.updateview();return}else{var w=this.totalrecords}}else{var y=0;var w=this.totalrecords}if(this.groupable&&this.groups.length>0&&this.loadgrouprecords){var t=y;t=this.loadgrouprecords(0,y,w,l,e,s,k,n,o)}else{A=this.loadflatrecords(y,w,l,e,s,k,n,o)}if(n>e){k.splice(e,n-e)}if(this.groups.length>0&&this.groupable){this.totalrows=t}else{this.totalrows=A}return o};this.loadflatrecords=function(d,p,e,q,l,u,o,r){var t=this;var k=d;var n=d;p=Math.min(p,this.totalrecords);var g=this.sortdata!=null;var f=this.source.id&&(this.source.datatype=="local"||this.source.datatype=="array"||this.source.datatype=="");var h=g?this.sortdata:this.records;for(obj=d;obj<p;obj++){var s={};if(!g){s=b.extend({},h[obj]);id=s[t.uniqueId];s.boundindex=k;t.loadedrecords[k]=s;if(!s.uid){s.uid=t.getid(t.source.id,s,k)}t.recordsbyid["id"+s.uid]=h[obj];s.uniqueid=t.generatekey();t.bounditems[this.bounditems.length]=s}else{s=b.extend({},h[obj].value);id=s[t.uniqueId];s.boundindex=h[obj].index;if(!s.uid){s.uid=t.getid(t.source.id,s,s.boundindex)}t.recordsbyid["id"+s.uid]=h[obj].value;t.loadedrecords[k]=s;s.uniqueid=t.generatekey();t.bounditems[s.boundindex]=s}if(q>=o||id!=u[q][t.uniqueId]||(l&&l[id])){r[r.length]=q}u[q]=s;q++;s.visibleindex=n;n++;k++}return n},this.updateview=function(o,p){var r=this;var k=this.pagesize*this.pagenum;var n=0;var s=new Array();var e=this.filters;var h=this.updated;var l=s.length;if(this.pageable){if(this.virtualmode){if(!this.groupable||this.groups.length==0){this.loadflatrecords(this.pagesize*this.pagenum,this.pagesize*(1+this.pagenum),e,n,h,s,l,[]);this.totalrows=s.length}else{if(this.groupable&&this.groups.length>0&&this.loadgrouprecords){if(this._cachegrouppages[this.pagenum+"_"+this.pagesize]!=undefined){this.rows=this._cachegrouppages[this.pagenum+"_"+this.pagesize];this.totalrows=this.rows.length;return}this.loadgrouprecords(0,this.pagesize*this.pagenum,this.pagesize*(1+this.pagenum),e,n,h,s,l,[]);this._cachegrouppages[this.pagenum+"_"+this.pagesize]=this.rows;this.totalrows=this.rows.length;return}}}}else{if(this.virtualmode&&(!this.groupable||this.groups.length==0)){var g=this.pagesize;if(g==0){g=Math.min(100,this.totalrecords)}var d=g*this.pagenum;if(this.loadedrecords.length==0){d=0}if(o!=null&&p!=null){this.loadflatrecords(o,p,e,n,h,s,l,[])}else{this.loadflatrecords(this.pagesize*this.pagenum,this.pagesize*(1+this.pagenum),e,n,h,s,l,[])}this.totalrows=this.loadedrecords.length;this.rows=s;if(s.length>=g){return}}}if(this.groupable&&this.pageable&&this.groups.length>0&&this._updategroupsinpage){s=this._updategroupsinpage(r,e,k,n,l,this.pagesize*this.pagenum,this.pagesize*(1+this.pagenum))}else{for(i=this.pagesize*this.pagenum;i<this.pagesize*(1+this.pagenum);i++){var q=i<this.loadedrecords.length?this.loadedrecords[i]:null;if(q==null){continue}if(!this.pagesize||(k>=this.pagesize*this.pagenum&&k<=this.pagesize*(this.pagenum+1))){s[n]=q;n++}k++}}if((s.length==0||s.length<this.pagesize)&&!this.pageable&&this.virtualmode){n=s.length;var f=s.length;for(i=this.pagesize*this.pagenum;i<this.pagesize*(1+this.pagenum)-f;i++){var q={};q.boundindex=i+f;q.visibleindex=i+f;q.uniqueid=r.generatekey();q.empty=true;r.bounditems[i+f]=q;s[n]=q;n++}}this.rows=s};this.generatekey=function(){var d=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(d()+d()+"-"+d()+"-"+d()+"-"+d()+"-"+d()+d()+d())};this.reloaddata=function(){this.reload(this.records,this.rows,this.filter,this.updated,true)};this.refresh=function(h){if(this.suspend){return}if(h==undefined){h=true}var n=this.rows.length;var l=this.totalrows;if(this.filters.length>0&&!this.virtualmode){var e="";var g=this.cachedrecords.length;var t=new Array();this.totalrecords=0;var o=this.cachedrecords;var f=this.filters.length;if(this.source!=null&&this.source.filter!=undefined&&this.source.localdata!=undefined){t=this.source.filter(this.filters,o,g);if(t==undefined){t=new Array()}this.records=t}else{if(this.source.filter==null||this.source.filter==undefined){for(row=0;row<g;row++){var p=o[row];var d=undefined;for(j=0;j<f;j++){var e=this.filters[j].filter;var s=p[this.filters[j].datafield];var u=e.evaluate(s);if(d==undefined){d=u}else{if(e.operator=="or"){d=d||u}else{d=d&&u}}}if(d){t[t.length]=b.extend({dataindex:row},p)}}this.records=t}}if(this.sortdata){var k=this.sortfield;if(this.sortcache[k]){this.sortdata=null;var q=this.sortcache[k].direction;this.sortcache[k]=null;this.sortby(this.sortfield,q);return}}}else{if(this.filters.length==0&&!this.virtualmode){if(this.cachedrecords){this.totalrecords=0;var o=this.cachedrecords;this.records=o;if(this.sortdata){var k=this.sortfield;if(this.sortcache[k]){this.sortdata=null;var q=this.sortcache[k].direction;this.sortcache[k]=null;this.sortby(this.sortfield,q);return}}}}}var r=this.reload(this.records,this.rows,this.filter,this.updated,h);this.updated=null;if(this.rowschangecallback!=null){if(l!=totalrows){this.rowschangecallback({type:"PagingChanged",data:getpagingdetails()})}if(n!=rows.length){this.rowschangecallback({type:"RowsCountChanged",data:{previous:n,current:rows.length}})}if(r.length>0||n!=rows.length){this.rowschangecallback({type:"RowsChanged",data:{previous:n,current:rows.length,diff:r}})}}};return this}})(jQuery);